<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Some useful tools in R | Tree phenology analysis with R</title>
  <meta name="description" content="Chapter 9 Some useful tools in R | Tree phenology analysis with R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Some useful tools in R | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Some useful tools in R | Tree phenology analysis with R" />
  
  
  

<meta name="author" content="Jacqueline Wingen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="making-hourly-temperatures.html"/>
<link rel="next" href="filling-gaps-in-temperature-records.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Analysis with R</a></li>
<li><a href="index.html"><img src="images/chillR_hexSticker.png" width="75%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the Module</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> Git and Github</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="3.6" data-path="tree-dormancy.html"><a href="tree-dormancy.html#excercises-on-tree-dormancy"><i class="fa fa-check"></i><b>3.6</b> <code>Excercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#whats-already-known"><i class="fa fa-check"></i><b>4.2</b> What’s already known</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projections-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projections approaches</a></li>
<li class="chapter" data-level="4.5" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises-on-climate-change"><i class="fa fa-check"></i><b>4.5</b> <code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.2</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.3</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.4</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.5</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.6</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.7</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.8</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.9</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.10</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.11</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.12</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.13</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.14" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises-on-past-chill-projections"><i class="fa fa-check"></i><b>5.14</b> <code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill.html"><a href="manual-chill.html"><i class="fa fa-check"></i><b>6</b> Manual chill</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill.html"><a href="manual-chill.html#learning-goals-3"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill.html"><a href="manual-chill.html#chilling-hours-calculation-using-chillr"><i class="fa fa-check"></i><b>6.2</b> Chilling hours calculation using chillR</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="manual-chill.html"><a href="manual-chill.html#data-requirements"><i class="fa fa-check"></i><b>6.2.1</b> <strong>Data Requirements</strong></a></li>
<li class="chapter" data-level="6.2.2" data-path="manual-chill.html"><a href="manual-chill.html#loading-and-preparing-data"><i class="fa fa-check"></i><b>6.2.2</b> Loading and Preparing Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="manual-chill.html"><a href="manual-chill.html#manual-calculation-of-chilling-hours"><i class="fa fa-check"></i><b>6.2.3</b> <strong>Manual Calculation of Chilling Hours</strong></a></li>
<li class="chapter" data-level="6.2.4" data-path="manual-chill.html"><a href="manual-chill.html#automation-with-functions"><i class="fa fa-check"></i><b>6.2.4</b> Automation with Functions</a></li>
<li class="chapter" data-level="6.2.5" data-path="manual-chill.html"><a href="manual-chill.html#application-example"><i class="fa fa-check"></i><b>6.2.5</b> Application Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manual-chill.html"><a href="manual-chill.html#exercises-on-basic-chill-modeling"><i class="fa fa-check"></i><b>6.3</b> <code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill.html"><a href="chill.html"><i class="fa fa-check"></i><b>7</b> Chill</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill.html"><a href="chill.html#learning-goals-4"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="chill.html"><a href="chill.html#chilling_hours-function"><i class="fa fa-check"></i><b>7.2</b> <code>Chilling_Hours()</code> function</a></li>
<li class="chapter" data-level="7.3" data-path="chill.html"><a href="chill.html#utah-model"><i class="fa fa-check"></i><b>7.3</b> Utah Model</a></li>
<li class="chapter" data-level="7.4" data-path="chill.html"><a href="chill.html#creating-custom-chill-models-with-step_model"><i class="fa fa-check"></i><b>7.4</b> Creating Custom Chill Models with <code>step_model()</code></a></li>
<li class="chapter" data-level="7.5" data-path="chill.html"><a href="chill.html#dynamic-model"><i class="fa fa-check"></i><b>7.5</b> Dynamic model</a></li>
<li class="chapter" data-level="7.6" data-path="chill.html"><a href="chill.html#chilling-and-tempresponse-functions"><i class="fa fa-check"></i><b>7.6</b> <code>Chilling</code> and <code>tempResponse</code> functions</a></li>
<li class="chapter" data-level="7.7" data-path="chill.html"><a href="chill.html#exercises-on-chill-models"><i class="fa fa-check"></i><b>7.7</b> <code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#learning-goals-5"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.2</b> Generating hourly temperatures</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.3</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.4" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.4</b> Empirical daily temperature curves</a></li>
<li class="chapter" data-level="8.5" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures"><i class="fa fa-check"></i><b>8.5</b> <code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#learning-goals-6"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.2</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.3</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.4</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.5</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.6</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.7</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.7.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.7.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.7.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.7.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.7.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.7.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.7.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.7.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.7.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.7.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.8</b> Loops</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.8.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.8.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.9</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.9.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.9.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.9.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises-on-useful-r-tools"><i class="fa fa-check"></i><b>9.10</b> <code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>10</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="10.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#learning-goals-7"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#gaps"><i class="fa fa-check"></i><b>10.2</b> Gaps</a></li>
<li class="chapter" data-level="10.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records"><i class="fa fa-check"></i><b>10.3</b> Filling short gaps in daily records</a></li>
<li class="chapter" data-level="10.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records"><i class="fa fa-check"></i><b>10.4</b> Filling long gaps in daily records</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals"><i class="fa fa-check"></i><b>10.4.1</b> Bias-correction for shorter intervals</a></li>
<li class="chapter" data-level="10.4.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later"><i class="fa fa-check"></i><b>10.4.2</b> Saving the data for later</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#exercises-on-filling-gaps"><i class="fa fa-check"></i><b>10.5</b> <code>Exercises</code> on filling gaps</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>11</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>11.1</b> Learning goals for this lesson</a></li>
<li class="chapter" data-level="11.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#temperature-data-needs"><i class="fa fa-check"></i><b>11.2</b> Temperature data needs</a></li>
<li class="chapter" data-level="11.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>11.3</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actionlist_stations"><i class="fa fa-check"></i><b>11.3.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="11.3.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actiondownload_weather"><i class="fa fa-check"></i><b>11.3.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>11.3.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#exercises-on-getting-temperature-data"><i class="fa fa-check"></i><b>11.4</b> <code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="some-useful-tools-in-r" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Some useful tools in R<a href="some-useful-tools-in-r.html#some-useful-tools-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-6" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Learning goals<a href="some-useful-tools-in-r.html#learning-goals-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Get to know some neat tools in R that can make coding more elegant - and easier</li>
<li>Get introduced to the <code>tidyverse</code></li>
<li>Learn about loops</li>
<li>Get to know the <code>apply</code> function family</li>
</ul>
</div>
<div id="an-evolving-language---and-a-lifelong-learning-process" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> An evolving language - and a lifelong learning process<a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The R universe is constantly evolving, offering much more now than the original base functions. Over time, modern tools and more elegant programming styles have become integral. In the upcoming chapters, some of these new tools will be introduced, along with the basics needed to use them effectively.</p>
</div>
<div id="the-tidyverse" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> The <code>tidyverse</code><a href="some-useful-tools-in-r.html#the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many of the tools introduced here come from the <code>tidyverse</code> - a collection of packages developed by <a href="https://en.wikipedia.org/wiki/Hadley_Wickham">Hadley Wickham</a> and his team. This collection offers many ways to improve programming skills. In this book, only the functions that are directly used will be covered. A big advantage of the tidyverse is that, with just one command - <code>library(tidyverse)</code> - all functions in the package collection become available.</p>
</div>
<div id="the-ggplot2-package" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> The <code>ggplot2</code> package<a href="some-useful-tools-in-r.html#the-ggplot2-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>ggplot2</code> package, first released by <a href="https://en.wikipedia.org/wiki/Hadley_Wickham">Hadley Wickham</a> in 2007, has become one of the most popular R packages because it greatly simplifies the creation of attractive graphics. The history of the package can be found <a href="https://en.wikipedia.org/wiki/Ggplot2">here</a>, and an introduction along with links to various tutorials is available <a href="https://ggplot2.tidyverse.org/">here</a>.</p>
</div>
<div id="the-tibble-package" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> The <code>tibble</code> package<a href="some-useful-tools-in-r.html#the-tibble-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <code>tibble</code> is an enhanced version of a <code>data.frame</code> that offers several improvements. The most notable improvement is that <code>tibbles</code> avoid the common <code>data.frame</code> behavior of unexpectedly converting strings into factors. Although <code>tibbles</code> are relatively new here, they will be used throughout the rest of the book.</p>
<p>To create a <code>tibble</code> from a regular <code>data.frame</code> (or a similar structure), the <code>as_tibble</code> command can be used:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="some-useful-tools-in-r.html#cb47-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb47-2"><a href="some-useful-tools-in-r.html#cb47-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(dat)</span>
<span id="cb47-3"><a href="some-useful-tools-in-r.html#cb47-3" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##       a     b
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     4
## 2     2     5
## 3     3     6</code></pre>
</div>
<div id="the-magrittr-package---pipes" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> The <code>magrittr</code> package - pipes<a href="some-useful-tools-in-r.html#the-magrittr-package---pipes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>Magrittr</code> helps organize steps applied to the same dataset by using the pipe operator <code>%&gt;%</code>. This operator links multiple operations on a data structure, such as a <code>tlibbe</code>, making it easier to perform tasks like calculating the sum of all numbers in the dataset:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="some-useful-tools-in-r.html#cb49-1" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<p>After the pipe operator <code>%&gt;%</code>, the next function automatically takes the piped-in data as its first input, so it’s unnecessary to specify it explicitly. Additional commands can be chained by adding more pipes. This approach allows for building more complex workflows, as shown in examples later.</p>
</div>
<div id="the-tidyr-package" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> The <code>tidyr</code> package<a href="some-useful-tools-in-r.html#the-tidyr-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>tidyr</code> package offers helpful functions for organizing data. The <code>KA_weather</code> dataset from <code>chillR</code> will be used here to illustrate some of these functions:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="some-useful-tools-in-r.html#cb51-1" tabindex="-1"></a>KAw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(KA_weather[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])</span>
<span id="cb51-2"><a href="some-useful-tools-in-r.html#cb51-2" tabindex="-1"></a>KAw</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##     Year Month   Day  Tmax  Tmin
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1998     1     1   8.2   5.1
##  2  1998     1     2   9.1   5  
##  3  1998     1     3  10.4   3.3
##  4  1998     1     4   8.4   4.5
##  5  1998     1     5   7.7   4.5
##  6  1998     1     6   8.1   4.4
##  7  1998     1     7  12     6.9
##  8  1998     1     8  11.2   8.6
##  9  1998     1     9  13.9   8.5
## 10  1998     1    10  14.5   3.6</code></pre>
<div id="pivot_longer" class="section level3 hasAnchor" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> <code>pivot_longer</code><a href="some-useful-tools-in-r.html#pivot_longer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>pivot_longer</code> function, introduced previously, is useful for reshaping data from separate columns (like <code>Tmin</code> and <code>Tmax</code>) into individual rows. In this setup, each day’s record will have a row for <code>Tmin</code> and another for <code>Tmax</code>. This transformation is often necessary for tasks like plotting data with the <code>ggplot2</code> package. The function can be combined with a pipe for a streamlined workflow:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="some-useful-tools-in-r.html#cb53-1" tabindex="-1"></a>KAwlong <span class="ot">&lt;-</span> KAw <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Tmax<span class="sc">:</span>Tmin)</span>
<span id="cb53-2"><a href="some-useful-tools-in-r.html#cb53-2" tabindex="-1"></a>KAwlong</span></code></pre></div>
<pre><code>## # A tibble: 20 × 5
##     Year Month   Day name  value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
##  1  1998     1     1 Tmax    8.2
##  2  1998     1     1 Tmin    5.1
##  3  1998     1     2 Tmax    9.1
##  4  1998     1     2 Tmin    5  
##  5  1998     1     3 Tmax   10.4
##  6  1998     1     3 Tmin    3.3
##  7  1998     1     4 Tmax    8.4
##  8  1998     1     4 Tmin    4.5
##  9  1998     1     5 Tmax    7.7
## 10  1998     1     5 Tmin    4.5
## 11  1998     1     6 Tmax    8.1
## 12  1998     1     6 Tmin    4.4
## 13  1998     1     7 Tmax   12  
## 14  1998     1     7 Tmin    6.9
## 15  1998     1     8 Tmax   11.2
## 16  1998     1     8 Tmin    8.6
## 17  1998     1     9 Tmax   13.9
## 18  1998     1     9 Tmin    8.5
## 19  1998     1    10 Tmax   14.5
## 20  1998     1    10 Tmin    3.6</code></pre>
<p>In this example, it was necessary to specify the columns to stack. The <code>pivot_longer</code> function serves a similar purpose to the <code>melt</code> function from the <code>reshape2</code> package, which was used previously and in earlier book editions. However, <code>pivot_longer</code> is more intuitive, so it will be used throughout the remaining chapters.</p>
</div>
<div id="pivot_wider" class="section level3 hasAnchor" number="9.7.2">
<h3><span class="header-section-number">9.7.2</span> <code>pivot_wider</code><a href="some-useful-tools-in-r.html#pivot_wider" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>pivot_wider</code> function allows for the opposite transformation of <code>pivot_longer</code>, converting rows back into separate columns:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="some-useful-tools-in-r.html#cb55-1" tabindex="-1"></a>KAwwide <span class="ot">&lt;-</span> KAwlong <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name) </span>
<span id="cb55-2"><a href="some-useful-tools-in-r.html#cb55-2" tabindex="-1"></a>KAwwide</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##     Year Month   Day  Tmax  Tmin
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1998     1     1   8.2   5.1
##  2  1998     1     2   9.1   5  
##  3  1998     1     3  10.4   3.3
##  4  1998     1     4   8.4   4.5
##  5  1998     1     5   7.7   4.5
##  6  1998     1     6   8.1   4.4
##  7  1998     1     7  12     6.9
##  8  1998     1     8  11.2   8.6
##  9  1998     1     9  13.9   8.5
## 10  1998     1    10  14.5   3.6</code></pre>
<p>The <code>names_from</code> argument in <code>pivot_wider</code> specifies the column that will provide the headers for the new columns. In some cases, <code>pivot_wider</code> might work without this argument, but it’s generally recommended to include it for clarity and to ensure that the function behaves as expected, especially with more complex datasets.</p>
</div>
<div id="select" class="section level3 hasAnchor" number="9.7.3">
<h3><span class="header-section-number">9.7.3</span> <code>select</code><a href="some-useful-tools-in-r.html#select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>select</code> function allows users to choose a subset of columns from a <code>data.frame</code> or <code>tibble</code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="some-useful-tools-in-r.html#cb57-1" tabindex="-1"></a>KAw <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Month, Day, Tmax))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    Month   Day  Tmax
##    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1     1     1   8.2
##  2     1     2   9.1
##  3     1     3  10.4
##  4     1     4   8.4
##  5     1     5   7.7
##  6     1     6   8.1
##  7     1     7  12  
##  8     1     8  11.2
##  9     1     9  13.9
## 10     1    10  14.5</code></pre>
</div>
<div id="filter" class="section level3 hasAnchor" number="9.7.4">
<h3><span class="header-section-number">9.7.4</span> <code>filter</code><a href="some-useful-tools-in-r.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>filter</code> function reduces a <code>data.frame</code> or <code>tibble</code> to just the rows that fulfill certain conditions:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="some-useful-tools-in-r.html#cb59-1" tabindex="-1"></a>KAw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Tmax <span class="sc">&gt;</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##    Year Month   Day  Tmax  Tmin
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  1998     1     3  10.4   3.3
## 2  1998     1     7  12     6.9
## 3  1998     1     8  11.2   8.6
## 4  1998     1     9  13.9   8.5
## 5  1998     1    10  14.5   3.6</code></pre>
</div>
<div id="mutate" class="section level3 hasAnchor" number="9.7.5">
<h3><span class="header-section-number">9.7.5</span> <code>mutate</code><a href="some-useful-tools-in-r.html#mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>mutate</code> function is essential for creating, modifying, and deleting columns in a <code>data.frame</code> or <code>tibble</code>. For example, it can be used to add new columns, such as converting <code>Tmin</code> and <code>Tmax</code> to Kelvin:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="some-useful-tools-in-r.html#cb61-1" tabindex="-1"></a>KAw_K <span class="ot">&lt;-</span> KAw <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Tmax_K =</span> Tmax <span class="sc">+</span> <span class="fl">273.15</span>, <span class="at">Tmin_K =</span> Tmin <span class="sc">+</span> <span class="fl">273.15</span>)</span>
<span id="cb61-2"><a href="some-useful-tools-in-r.html#cb61-2" tabindex="-1"></a>KAw_K</span></code></pre></div>
<pre><code>## # A tibble: 10 × 7
##     Year Month   Day  Tmax  Tmin Tmax_K Tmin_K
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  1998     1     1   8.2   5.1   281.   278.
##  2  1998     1     2   9.1   5     282.   278.
##  3  1998     1     3  10.4   3.3   284.   276.
##  4  1998     1     4   8.4   4.5   282.   278.
##  5  1998     1     5   7.7   4.5   281.   278.
##  6  1998     1     6   8.1   4.4   281.   278.
##  7  1998     1     7  12     6.9   285.   280.
##  8  1998     1     8  11.2   8.6   284.   282.
##  9  1998     1     9  13.9   8.5   287.   282.
## 10  1998     1    10  14.5   3.6   288.   277.</code></pre>
<p>To delete the columns created with <code>mutate</code>, you can set them to <code>NULL</code>. This effectively removes the specified columns from the <code>data.frame</code> or <code>tibble</code>:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="some-useful-tools-in-r.html#cb63-1" tabindex="-1"></a>KAw_K <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Tmin_K =</span> <span class="cn">NULL</span>, <span class="at">Tmax_K =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##     Year Month   Day  Tmax  Tmin
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1998     1     1   8.2   5.1
##  2  1998     1     2   9.1   5  
##  3  1998     1     3  10.4   3.3
##  4  1998     1     4   8.4   4.5
##  5  1998     1     5   7.7   4.5
##  6  1998     1     6   8.1   4.4
##  7  1998     1     7  12     6.9
##  8  1998     1     8  11.2   8.6
##  9  1998     1     9  13.9   8.5
## 10  1998     1    10  14.5   3.6</code></pre>
<p>Next, the original temperature values will be replaced directly with their corresponding Kelvin values. The following code will make these modifications to the specified columns:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="some-useful-tools-in-r.html#cb65-1" tabindex="-1"></a>KAw <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Tmin =</span> Tmin <span class="sc">+</span> <span class="fl">273.15</span>, <span class="at">Tmax =</span> Tmax <span class="sc">+</span> <span class="fl">273.15</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##     Year Month   Day  Tmax  Tmin
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1998     1     1  281.  278.
##  2  1998     1     2  282.  278.
##  3  1998     1     3  284.  276.
##  4  1998     1     4  282.  278.
##  5  1998     1     5  281.  278.
##  6  1998     1     6  281.  278.
##  7  1998     1     7  285.  280.
##  8  1998     1     8  284.  282.
##  9  1998     1     9  287.  282.
## 10  1998     1    10  288.  277.</code></pre>
</div>
<div id="arrange" class="section level3 hasAnchor" number="9.7.6">
<h3><span class="header-section-number">9.7.6</span> <code>arrange</code><a href="some-useful-tools-in-r.html#arrange" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>arrange</code> is a function to sort data in <code>data.frames</code> or <code>tibbles</code>:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="some-useful-tools-in-r.html#cb67-1" tabindex="-1"></a>KAw <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Tmax, Tmin)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##     Year Month   Day  Tmax  Tmin
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1998     1     5   7.7   4.5
##  2  1998     1     6   8.1   4.4
##  3  1998     1     1   8.2   5.1
##  4  1998     1     4   8.4   4.5
##  5  1998     1     2   9.1   5  
##  6  1998     1     3  10.4   3.3
##  7  1998     1     8  11.2   8.6
##  8  1998     1     7  12     6.9
##  9  1998     1     9  13.9   8.5
## 10  1998     1    10  14.5   3.6</code></pre>
<p>It is also possible to sort a <code>data.frame</code> or <code>tibble</code> in descending order:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="some-useful-tools-in-r.html#cb69-1" tabindex="-1"></a>KAw <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Tmax), Tmin)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##     Year Month   Day  Tmax  Tmin
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1998     1    10  14.5   3.6
##  2  1998     1     9  13.9   8.5
##  3  1998     1     7  12     6.9
##  4  1998     1     8  11.2   8.6
##  5  1998     1     3  10.4   3.3
##  6  1998     1     2   9.1   5  
##  7  1998     1     4   8.4   4.5
##  8  1998     1     1   8.2   5.1
##  9  1998     1     6   8.1   4.4
## 10  1998     1     5   7.7   4.5</code></pre>
</div>
</div>
<div id="loops" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Loops<a href="some-useful-tools-in-r.html#loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In addition to the <code>tidyverse</code> functions, understanding loops is essential for efficient coding. Loops enable the repetition of operations multiple times without needing to retype or copy and paste code. They also allow for modifications to be made with each iteration. While detailed explanations on loops can be found elsewhere, the basics will be covered here.</p>
<p>There are two primary types of loops: <strong>for loops</strong> and <strong>while loops</strong>. For both types, it is necessary to provide instructions that determine how many times the loop will run, as well as what actions to perform during each iteration.</p>
<div id="for-loops" class="section level3 hasAnchor" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> <em>For</em> loops<a href="some-useful-tools-in-r.html#for-loops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a for loop, explicit instructions dictate how many times the code inside the loop should be executed. This is typically done by providing a vector or list of elements, directing R to run the code for each of these elements. As a result, the number of executions corresponds to the number of elements in the vector or list. A counter is needed to track the current iteration, commonly referred to as <code>i</code>, though it can be any variable name:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="some-useful-tools-in-r.html#cb71-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="fu">print</span>(<span class="st">&quot;Hello&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Hello&quot;
## [1] &quot;Hello&quot;
## [1] &quot;Hello&quot;</code></pre>
<p>This command executed the code three times, producing the same output with each iteration. The structure can be made more complex by including multiple lines of code within curly brackets:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="some-useful-tools-in-r.html#cb73-1" tabindex="-1"></a>addition <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb73-2"><a href="some-useful-tools-in-r.html#cb73-2" tabindex="-1"></a></span>
<span id="cb73-3"><a href="some-useful-tools-in-r.html#cb73-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb73-4"><a href="some-useful-tools-in-r.html#cb73-4" tabindex="-1"></a>{</span>
<span id="cb73-5"><a href="some-useful-tools-in-r.html#cb73-5" tabindex="-1"></a>  addition <span class="ot">&lt;-</span> addition <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb73-6"><a href="some-useful-tools-in-r.html#cb73-6" tabindex="-1"></a>  <span class="fu">print</span>(addition)</span>
<span id="cb73-7"><a href="some-useful-tools-in-r.html#cb73-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 2
## [1] 3
## [1] 4</code></pre>
<p>The code in this loop incremented an initial value of 1 by 1 in each iteration and printed the resulting value. It is important to note that R may require explicit instructions to <code>print</code> these values when the operation is embedded within a loop.</p>
<p>By utilizing the index <code>i</code> within the code block, additional flexibility can be introduced to the operations performed in each iteration:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="some-useful-tools-in-r.html#cb75-1" tabindex="-1"></a>addition <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-2"><a href="some-useful-tools-in-r.html#cb75-2" tabindex="-1"></a></span>
<span id="cb75-3"><a href="some-useful-tools-in-r.html#cb75-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb75-4"><a href="some-useful-tools-in-r.html#cb75-4" tabindex="-1"></a>{</span>
<span id="cb75-5"><a href="some-useful-tools-in-r.html#cb75-5" tabindex="-1"></a>  addition <span class="ot">&lt;-</span> addition <span class="sc">+</span> i</span>
<span id="cb75-6"><a href="some-useful-tools-in-r.html#cb75-6" tabindex="-1"></a>  <span class="fu">print</span>(addition)</span>
<span id="cb75-7"><a href="some-useful-tools-in-r.html#cb75-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 2
## [1] 4
## [1] 7</code></pre>
<p>In this iteration, the respective value of <code>i</code> was added to the initial element during each run. Additionally, <code>i</code> can be utilized in more creative ways within the loop to enhance the operations being performed:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="some-useful-tools-in-r.html#cb77-1" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Paul&quot;</span>, <span class="st">&quot;Mary&quot;</span>, <span class="st">&quot;John&quot;</span>)</span>
<span id="cb77-2"><a href="some-useful-tools-in-r.html#cb77-2" tabindex="-1"></a></span>
<span id="cb77-3"><a href="some-useful-tools-in-r.html#cb77-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb77-4"><a href="some-useful-tools-in-r.html#cb77-4" tabindex="-1"></a>{</span>
<span id="cb77-5"><a href="some-useful-tools-in-r.html#cb77-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Hello&quot;</span>, names[i]))</span>
<span id="cb77-6"><a href="some-useful-tools-in-r.html#cb77-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Hello Paul&quot;
## [1] &quot;Hello Mary&quot;
## [1] &quot;Hello John&quot;</code></pre>
<p>The counter in a loop does not have to be numeric; it can take on various forms, including strings. By using this flexibility, the same output as generated in the previous code block can be achieved with a different formulation:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="some-useful-tools-in-r.html#cb79-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;Paul&quot;</span>, <span class="st">&quot;Mary&quot;</span>, <span class="st">&quot;John&quot;</span>))</span>
<span id="cb79-2"><a href="some-useful-tools-in-r.html#cb79-2" tabindex="-1"></a>{</span>
<span id="cb79-3"><a href="some-useful-tools-in-r.html#cb79-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Hello&quot;</span>, i))</span>
<span id="cb79-4"><a href="some-useful-tools-in-r.html#cb79-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Hello Paul&quot;
## [1] &quot;Hello Mary&quot;
## [1] &quot;Hello John&quot;</code></pre>
</div>
<div id="while-loops" class="section level3 hasAnchor" number="9.8.2">
<h3><span class="header-section-number">9.8.2</span> <em>While</em> loops<a href="some-useful-tools-in-r.html#while-loops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A loop can also be controlled using a <code>while</code> statement, which executes the code until a specified condition is no longer met. This approach is meaningful only if the condition can change based on the operations performed within the loop:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="some-useful-tools-in-r.html#cb81-1" tabindex="-1"></a>cond <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb81-2"><a href="some-useful-tools-in-r.html#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="some-useful-tools-in-r.html#cb81-3" tabindex="-1"></a><span class="cf">while</span> (cond <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb81-4"><a href="some-useful-tools-in-r.html#cb81-4" tabindex="-1"></a>{</span>
<span id="cb81-5"><a href="some-useful-tools-in-r.html#cb81-5" tabindex="-1"></a>  <span class="fu">print</span>(cond)</span>
<span id="cb81-6"><a href="some-useful-tools-in-r.html#cb81-6" tabindex="-1"></a>  cond <span class="ot">&lt;-</span> cond <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb81-7"><a href="some-useful-tools-in-r.html#cb81-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 5
## [1] 4
## [1] 3
## [1] 2
## [1] 1</code></pre>
<p>Once <code>cond</code> reaches 0, the starting condition is no longer satisfied, and the code will not execute again. It is important to note that while loops can lead to issues if the condition remains true regardless of the code block’s execution. In such cases, the code may become stuck and will need to be manually interrupted.</p>
</div>
</div>
<div id="apply-functions" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> <code>apply</code> functions<a href="some-useful-tools-in-r.html#apply-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In addition to loops, R offers a more efficient way to perform operations on multiple elements simultaneously. This method, which is often faster, utilizes functions from the <strong>apply</strong> family: <code>apply</code>, <code>lapply</code>, and <code>sapply</code>. These functions require two key arguments: the list of items to which the operation will be applied and the operation itself.</p>
<div id="sapply" class="section level3 hasAnchor" number="9.9.1">
<h3><span class="header-section-number">9.9.1</span> <code>sapply</code><a href="some-useful-tools-in-r.html#sapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the goal is to apply an operation to a vector of elements, the simplest function to use is <code>sapply</code>. It requires two arguments: the vector (<code>X</code>) and the function to be applied (<code>FUN</code>). For illustration, a simple function called <code>func</code> will be created, which adds 1 to an input object:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="some-useful-tools-in-r.html#cb83-1" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb83-2"><a href="some-useful-tools-in-r.html#cb83-2" tabindex="-1"></a>  x <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb83-3"><a href="some-useful-tools-in-r.html#cb83-3" tabindex="-1"></a></span>
<span id="cb83-4"><a href="some-useful-tools-in-r.html#cb83-4" tabindex="-1"></a><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, func)</span></code></pre></div>
<pre><code>## [1] 2 3 4 5 6</code></pre>
<p>The output is a vector of numbers that are each 1 greater than the corresponding elements of the input vector. When this function is applied to a list of numbers, the output becomes a matrix, although the values remain the same:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="some-useful-tools-in-r.html#cb85-1" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), func)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    2
## [2,]    3
## [3,]    4
## [4,]    5
## [5,]    6</code></pre>
</div>
<div id="lapply" class="section level3 hasAnchor" number="9.9.2">
<h3><span class="header-section-number">9.9.2</span> <code>lapply</code><a href="some-useful-tools-in-r.html#lapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To obtain a list as the output, the <code>lapply</code> function can be used. This function treats the input element <code>X</code> as a list and returns a new list containing the same number of elements as the input. Each element in the output list corresponds to the result of applying <code>FUN</code> to the respective element of the input list:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="some-useful-tools-in-r.html#cb87-1" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, func)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 4
## 
## [[4]]
## [1] 5
## 
## [[5]]
## [1] 6</code></pre>
<p>If the input element <code>X</code> is a list, <code>lapply</code> treats the entire list as a single input element, applying <code>FUN</code> to the whole list and returning the result as one element in the output list. An example can help clarify this behavior:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="some-useful-tools-in-r.html#cb89-1" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), func)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2 3 4 5 6</code></pre>
</div>
<div id="apply" class="section level3 hasAnchor" number="9.9.3">
<h3><span class="header-section-number">9.9.3</span> <code>apply</code><a href="some-useful-tools-in-r.html#apply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The basic <code>apply</code> function is designed for applying functions to arrays, allowing operations to be performed either on the rows (<code>MARGIN = 1</code>) or on the columns (<code>MARGIN = 2</code>) of the array. While this function may not be used frequently, here are some simple examples of its functionality. For further information, it is advisable to consult the help file or explore online resources, as there are many helpful materials available.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="some-useful-tools-in-r.html#cb91-1" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb91-2"><a href="some-useful-tools-in-r.html#cb91-2" tabindex="-1"></a>mat</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    1    2    3
## [3,]    1    2    3</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="some-useful-tools-in-r.html#cb93-1" tabindex="-1"></a><span class="fu">apply</span>(mat, <span class="at">MARGIN =</span> <span class="dv">1</span>, sum) <span class="co"># adding up all the data in each row</span></span></code></pre></div>
<pre><code>## [1] 6 6 6</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="some-useful-tools-in-r.html#cb95-1" tabindex="-1"></a><span class="fu">apply</span>(mat, <span class="at">MARGIN =</span> <span class="dv">2</span>, sum) <span class="co"># adding up all the data in each column</span></span></code></pre></div>
<pre><code>## [1] 3 6 9</code></pre>
</div>
</div>
<div id="exercises-on-useful-r-tools" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> <code>Exercises</code> on useful R tools<a href="some-useful-tools-in-r.html#exercises-on-useful-r-tools" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><em>Based on the</em> <code>Winters_hours_gaps</code> <em>dataset, use</em> <code>magrittr</code> <em>pipes and functions of the</em> <code>tidyverse</code> <em>to accomplish the following:</em></li>
</ol>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li><em>Convert the dataset into a</em> <code>tibble</code></li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li><em>Select only the top 10 rows of the dataset</em></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="some-useful-tools-in-r.html#cb97-1" tabindex="-1"></a>WHG <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Winters_hours_gaps[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ])</span>
<span id="cb97-2"><a href="some-useful-tools-in-r.html#cb97-2" tabindex="-1"></a>WHG</span></code></pre></div>
<pre><code>## # A tibble: 10 × 6
##     Year Month   Day  Hour Temp_gaps  Temp
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1  2008     3     3    10      15.1  15.1
##  2  2008     3     3    11      17.2  17.2
##  3  2008     3     3    12      18.7  18.7
##  4  2008     3     3    13      18.7  18.7
##  5  2008     3     3    14      18.8  18.8
##  6  2008     3     3    15      19.5  19.5
##  7  2008     3     3    16      19.3  19.3
##  8  2008     3     3    17      17.7  17.7
##  9  2008     3     3    18      15.4  15.4
## 10  2008     3     3    19      12.7  12.7</code></pre>
<ul>
<li><ol start="3" style="list-style-type: lower-alpha">
<li><em>Convert the</em> <code>tibble</code> <em>to a</em> <code>long</code> <em>format, with separate rows for</em> <code>Temp_gaps</code> <em>and</em> <code>Temp</code></li>
</ol></li>
</ul>
<p>To see the difference between the columns <code>Temp_gaps</code> and <code>Temp</code>, rows 279 to 302 (Julian Day 15) are used below:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="some-useful-tools-in-r.html#cb99-1" tabindex="-1"></a>WHG <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Winters_hours_gaps[<span class="dv">279</span><span class="sc">:</span><span class="dv">302</span>, ])</span>
<span id="cb99-2"><a href="some-useful-tools-in-r.html#cb99-2" tabindex="-1"></a>WHGlong <span class="ot">&lt;-</span> WHG <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Temp_gaps<span class="sc">:</span>Temp)</span>
<span id="cb99-3"><a href="some-useful-tools-in-r.html#cb99-3" tabindex="-1"></a>WHGlong</span></code></pre></div>
<pre><code>## # A tibble: 48 × 6
##     Year Month   Day  Hour name      value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1  2008     3    15     0 Temp_gaps  6.76
##  2  2008     3    15     0 Temp       6.76
##  3  2008     3    15     1 Temp_gaps  6.48
##  4  2008     3    15     1 Temp       6.48
##  5  2008     3    15     2 Temp_gaps  5.51
##  6  2008     3    15     2 Temp       5.51
##  7  2008     3    15     3 Temp_gaps  6.89
##  8  2008     3    15     3 Temp       6.89
##  9  2008     3    15     4 Temp_gaps  6.10
## 10  2008     3    15     4 Temp       6.10
## # ℹ 38 more rows</code></pre>
<ul>
<li><ol start="4" style="list-style-type: lower-alpha">
<li><em>Use</em> <code>ggplot2</code> <em>to plot</em> <code>Temp_gaps</code> <em>and</em> <code>Temp</code> <em>as facets (point or line plot)</em></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="some-useful-tools-in-r.html#cb101-1" tabindex="-1"></a><span class="fu">ggplot</span>(WHGlong, <span class="fu">aes</span>(Hour, value)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="some-useful-tools-in-r.html#cb101-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb101-3"><a href="some-useful-tools-in-r.html#cb101-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(name)) <span class="sc">+</span></span>
<span id="cb101-4"><a href="some-useful-tools-in-r.html#cb101-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Temperature (°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="some-useful-tools-in-r.html#cb101-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<ul>
<li><ol start="5" style="list-style-type: lower-alpha">
<li><em>Convert the dataset back to the</em> <code>wide</code> <em>format</em></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="some-useful-tools-in-r.html#cb102-1" tabindex="-1"></a>WHGwide <span class="ot">&lt;-</span> WHGlong <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name)</span>
<span id="cb102-2"><a href="some-useful-tools-in-r.html#cb102-2" tabindex="-1"></a>WHGwide</span></code></pre></div>
<pre><code>## # A tibble: 24 × 6
##     Year Month   Day  Hour Temp_gaps  Temp
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1  2008     3    15     0      6.76  6.76
##  2  2008     3    15     1      6.48  6.48
##  3  2008     3    15     2      5.51  5.51
##  4  2008     3    15     3      6.89  6.89
##  5  2008     3    15     4      6.10  6.10
##  6  2008     3    15     5     NA     6.91
##  7  2008     3    15     6     NA     6.10
##  8  2008     3    15     7     NA     5.98
##  9  2008     3    15     8     NA     8.99
## 10  2008     3    15     9     10.8  10.8 
## # ℹ 14 more rows</code></pre>
<ul>
<li><ol start="6" style="list-style-type: lower-alpha">
<li><em>Select only the following columns:</em> <code>Year</code>, <code>Month</code>, <code>Day</code> <em>and</em> <code>Temp</code></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="some-useful-tools-in-r.html#cb104-1" tabindex="-1"></a>WHG <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Year, Month, Day, Temp))</span></code></pre></div>
<pre><code>## # A tibble: 24 × 4
##     Year Month   Day  Temp
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1  2008     3    15  6.76
##  2  2008     3    15  6.48
##  3  2008     3    15  5.51
##  4  2008     3    15  6.89
##  5  2008     3    15  6.10
##  6  2008     3    15  6.91
##  7  2008     3    15  6.10
##  8  2008     3    15  5.98
##  9  2008     3    15  8.99
## 10  2008     3    15 10.8 
## # ℹ 14 more rows</code></pre>
<ul>
<li><ol start="7" style="list-style-type: lower-alpha">
<li><em>Sort the dataset by the</em> <code>Temp</code> <em>column, in descending order</em></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="some-useful-tools-in-r.html#cb106-1" tabindex="-1"></a>WHG <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Temp))</span></code></pre></div>
<pre><code>## # A tibble: 24 × 6
##     Year Month   Day  Hour Temp_gaps  Temp
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1  2008     3    15    13      NA    15.2
##  2  2008     3    15    16      14.5  14.5
##  3  2008     3    15    14      NA    14.2
##  4  2008     3    15    12      NA    14.2
##  5  2008     3    15    15      14.1  14.1
##  6  2008     3    15    11      NA    13.6
##  7  2008     3    15    17      13.3  13.3
##  8  2008     3    15    18      12.1  12.1
##  9  2008     3    15    10      12.0  12.0
## 10  2008     3    15     9      10.8  10.8
## # ℹ 14 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><em>For the</em> <code>Winter_hours_gaps</code> <em>dataset, write a</em> <code>for</code> <em>loop to convert all temperatures</em> <em>(</em><code>Temp</code> <em>column) to degrees Fahrenheit</em></li>
</ol>
<p>So that the execution of the following code does not take too long, only Julian Day 15 (rows 279 to 302) is used here. To convert the entire <code>Temp</code> column to Fahrenheit, just omit <code>[279:302]</code></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="some-useful-tools-in-r.html#cb108-1" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Winters_hours_gaps<span class="sc">$</span>Temp[<span class="dv">279</span><span class="sc">:</span><span class="dv">302</span>]</span>
<span id="cb108-2"><a href="some-useful-tools-in-r.html#cb108-2" tabindex="-1"></a></span>
<span id="cb108-3"><a href="some-useful-tools-in-r.html#cb108-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> Temp)</span>
<span id="cb108-4"><a href="some-useful-tools-in-r.html#cb108-4" tabindex="-1"></a>{</span>
<span id="cb108-5"><a href="some-useful-tools-in-r.html#cb108-5" tabindex="-1"></a>  Fahrenheit <span class="ot">&lt;-</span> i <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span> </span>
<span id="cb108-6"><a href="some-useful-tools-in-r.html#cb108-6" tabindex="-1"></a>  <span class="fu">print</span>(Fahrenheit)</span>
<span id="cb108-7"><a href="some-useful-tools-in-r.html#cb108-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 44.1734
## [1] 43.6712
## [1] 41.9252
## [1] 44.4002
## [1] 42.9836
## [1] 44.4452
## [1] 42.9836
## [1] 42.755
## [1] 48.182
## [1] 51.3698
## [1] 53.69
## [1] 56.4692
## [1] 57.506
## [1] 59.4446
## [1] 57.5492
## [1] 57.3332
## [1] 58.1522
## [1] 55.9058
## [1] 53.8196
## [1] 49.4708
## [1] 47.6474
## [1] 47.3342
## [1] 48.182
## [1] 47.7806</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><em>Execute the same operation with a function from the</em> <code>apply</code> <em>family</em></li>
</ol>
<p>Here it is the same as in 2, just omit <code>[279:302]</code> to convert the entire <code>Temp</code> column</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="some-useful-tools-in-r.html#cb110-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> Winters_hours_gaps<span class="sc">$</span>Temp</span>
<span id="cb110-2"><a href="some-useful-tools-in-r.html#cb110-2" tabindex="-1"></a></span>
<span id="cb110-3"><a href="some-useful-tools-in-r.html#cb110-3" tabindex="-1"></a>fahrenheit <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb110-4"><a href="some-useful-tools-in-r.html#cb110-4" tabindex="-1"></a>  x <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span></span>
<span id="cb110-5"><a href="some-useful-tools-in-r.html#cb110-5" tabindex="-1"></a></span>
<span id="cb110-6"><a href="some-useful-tools-in-r.html#cb110-6" tabindex="-1"></a><span class="fu">sapply</span>(x[<span class="dv">279</span><span class="sc">:</span><span class="dv">302</span>], fahrenheit)</span></code></pre></div>
<pre><code>##  [1] 44.1734 43.6712 41.9252 44.4002 42.9836 44.4452 42.9836 42.7550 48.1820 51.3698 53.6900
## [12] 56.4692 57.5060 59.4446 57.5492 57.3332 58.1522 55.9058 53.8196 49.4708 47.6474 47.3342
## [23] 48.1820 47.7806</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><em>Now use the</em> <code>tidyverse</code> <em>function</em> <code>mutate</code> <em>to achieve the same outcome</em></li>
</ol>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="some-useful-tools-in-r.html#cb112-1" tabindex="-1"></a>WHG_F <span class="ot">&lt;-</span> WHG <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Temp_F =</span> Temp <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">+</span> <span class="dv">32</span>)</span>
<span id="cb112-2"><a href="some-useful-tools-in-r.html#cb112-2" tabindex="-1"></a>WHG_F</span></code></pre></div>
<pre><code>## # A tibble: 24 × 7
##     Year Month   Day  Hour Temp_gaps  Temp Temp_F
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1  2008     3    15     0      6.76  6.76   44.2
##  2  2008     3    15     1      6.48  6.48   43.7
##  3  2008     3    15     2      5.51  5.51   41.9
##  4  2008     3    15     3      6.89  6.89   44.4
##  5  2008     3    15     4      6.10  6.10   43.0
##  6  2008     3    15     5     NA     6.91   44.4
##  7  2008     3    15     6     NA     6.10   43.0
##  8  2008     3    15     7     NA     5.98   42.8
##  9  2008     3    15     8     NA     8.99   48.2
## 10  2008     3    15     9     10.8  10.8    51.4
## # ℹ 14 more rows</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="making-hourly-temperatures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="filling-gaps-in-temperature-records.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/edit/main/09-tools_R.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/blob/main/09-tools_R.Rmd",
"text": null
},
"download": ["bookdownproj.pdf", "bookdownproj.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"fig_caption": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
