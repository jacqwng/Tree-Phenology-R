<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Making hourly temperatures | Tree phenology analysis with R</title>
  <meta name="description" content="Chapter 8 Making hourly temperatures | Tree phenology analysis with R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Making hourly temperatures | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Making hourly temperatures | Tree phenology analysis with R" />
  
  
  

<meta name="author" content="Jacqueline Wingen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chill.html"/>
<link rel="next" href="some-useful-tools-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Analysis with R</a></li>
<li><a href="index.html"><img src="images/chillR_hexSticker.png" width="75%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the Module</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> Git and Github</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="3.6" data-path="tree-dormancy.html"><a href="tree-dormancy.html#excercises-on-tree-dormancy"><i class="fa fa-check"></i><b>3.6</b> <code>Excercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#whats-already-known"><i class="fa fa-check"></i><b>4.2</b> What’s already known</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projections-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projections approaches</a></li>
<li class="chapter" data-level="4.5" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises-on-climate-change"><i class="fa fa-check"></i><b>4.5</b> <code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.2</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.3</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.4</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.5</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.6</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.7</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.8</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.9</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.10</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.11</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.12</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.13</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.14" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises-on-past-chill-projections"><i class="fa fa-check"></i><b>5.14</b> <code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill.html"><a href="manual-chill.html"><i class="fa fa-check"></i><b>6</b> Manual chill</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill.html"><a href="manual-chill.html#learning-goals-3"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill.html"><a href="manual-chill.html#chilling-hours-calculation-using-chillr"><i class="fa fa-check"></i><b>6.2</b> Chilling hours calculation using chillR</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="manual-chill.html"><a href="manual-chill.html#data-requirements"><i class="fa fa-check"></i><b>6.2.1</b> <strong>Data Requirements</strong></a></li>
<li class="chapter" data-level="6.2.2" data-path="manual-chill.html"><a href="manual-chill.html#loading-and-preparing-data"><i class="fa fa-check"></i><b>6.2.2</b> Loading and Preparing Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="manual-chill.html"><a href="manual-chill.html#manual-calculation-of-chilling-hours"><i class="fa fa-check"></i><b>6.2.3</b> <strong>Manual Calculation of Chilling Hours</strong></a></li>
<li class="chapter" data-level="6.2.4" data-path="manual-chill.html"><a href="manual-chill.html#automation-with-functions"><i class="fa fa-check"></i><b>6.2.4</b> Automation with Functions</a></li>
<li class="chapter" data-level="6.2.5" data-path="manual-chill.html"><a href="manual-chill.html#application-example"><i class="fa fa-check"></i><b>6.2.5</b> Application Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manual-chill.html"><a href="manual-chill.html#exercises-on-basic-chill-modeling"><i class="fa fa-check"></i><b>6.3</b> <code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill.html"><a href="chill.html"><i class="fa fa-check"></i><b>7</b> Chill</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill.html"><a href="chill.html#learning-goals-4"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="chill.html"><a href="chill.html#chilling_hours-function"><i class="fa fa-check"></i><b>7.2</b> <code>Chilling_Hours()</code> function</a></li>
<li class="chapter" data-level="7.3" data-path="chill.html"><a href="chill.html#utah-model"><i class="fa fa-check"></i><b>7.3</b> Utah Model</a></li>
<li class="chapter" data-level="7.4" data-path="chill.html"><a href="chill.html#creating-custom-chill-models-with-step_model"><i class="fa fa-check"></i><b>7.4</b> Creating Custom Chill Models with <code>step_model()</code></a></li>
<li class="chapter" data-level="7.5" data-path="chill.html"><a href="chill.html#dynamic-model"><i class="fa fa-check"></i><b>7.5</b> Dynamic model</a></li>
<li class="chapter" data-level="7.6" data-path="chill.html"><a href="chill.html#chilling-and-tempresponse-functions"><i class="fa fa-check"></i><b>7.6</b> <code>Chilling</code> and <code>tempResponse</code> functions</a></li>
<li class="chapter" data-level="7.7" data-path="chill.html"><a href="chill.html#exercises-on-chill-models"><i class="fa fa-check"></i><b>7.7</b> <code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#learning-goals-5"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.2</b> Generating hourly temperatures</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.3</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.4" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.4</b> Empirical daily temperature curves</a></li>
<li class="chapter" data-level="8.5" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures"><i class="fa fa-check"></i><b>8.5</b> <code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#learning-goals-6"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.2</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.3</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.4</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.5</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.6</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.7</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.7.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.7.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.7.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.7.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.7.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.7.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.7.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.7.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.7.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.7.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.8</b> Loops</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.8.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.8.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.9</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.9.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.9.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.9.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises-on-useful-r-tools"><i class="fa fa-check"></i><b>9.10</b> <code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>10.1</b> Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.2</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.3</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.3.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.3.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.3.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.3.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.3.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#exercises-on-getting-temperature-data"><i class="fa fa-check"></i><b>10.4</b> <code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="making-hourly-temperatures" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Making hourly temperatures<a href="making-hourly-temperatures.html#making-hourly-temperatures" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-5" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Learning goals<a href="making-hourly-temperatures.html#learning-goals-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Understand why we often need hourly temperature data and why we need ways of making them out of daily data</li>
<li>Understand some basic algorithms for making hourly data from daily minimum and maximum temperatures</li>
<li>Understand how we can make use of observed hourly temperatures to produce our own empirical transfer function that can make hourly from daily data</li>
<li>Be able to use the respective <code>chillR</code> functions that implement these steps</li>
</ul>
</div>
<div id="generating-hourly-temperatures" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Generating hourly temperatures<a href="making-hourly-temperatures.html#generating-hourly-temperatures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With the Chilling Hours function developed, the next challenge arises from the limited availability of hourly temperature data, as most sources provide only daily minimum and maximum temperatures. This limitation complicates the direct calculation of Chilling Hours. Various methods have been employed to address this issue, including relating Chilling Hours to minimum temperatures (Crossa-Raynaud, 1955) or using complex equations.</p>
<p>With better computing tools, some researchers started to assume that daily minimum and maximum temperatures occur at specific times and used linear interpolation for the hours in between, creating a triangular shape for daily temperature patterns (<a href="https://link.springer.com/article/10.1007/s10584-007-9367-8">Baldocchi &amp; Wong, 2008</a>).</p>
<p><img src="bookdownproj_files/figure-html/triangular-1.png" width="80%" height="50%" /></p>
<p>While assuming a triangular temperature pattern may serve as a rough approximation, it is not entirely realistic. The rate of temperature increase in the morning differs from the rate of decrease in the evening. Additionally, the timing of the lowest daily temperature varies significantly throughout the year, particularly outside of equatorial regions. Therefore, it is important to take these variations into account.</p>
</div>
<div id="idealized-daily-temperature-curves" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Idealized daily temperature curves<a href="making-hourly-temperatures.html#idealized-daily-temperature-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A major breakthrough in modeling daily temperature curves was made when <a href="https://journals.ashs.org/hortsci/view/journals/hortsci/25/1/article-p14.xml">Dale E. Linvill</a> from Clemson University published a paper in 1990. He combined two mathematical equations: a sine curve to represent warming during the day and a logarithmic decay function for cooling at night. The times for sunrise and sunset defined the transition between these phases, and the length of each phase was linked to the amount of daylight. This method allowed for more accurate daily temperature curves than previous approaches, but not all researchers adopted these equations due to a lack of awareness or data processing skills.</p>
<p>One challenge with Linvill’s equations was their dependence on local sunrise and sunset times. While these can be calculated from observations, having a general method would help researchers. Fortunately, for areas without major geographical features, sunrise and sunset times can be calculated based on solar system geometry. Although agricultural scientists may not be familiar with this, they can use insights from other fields. The <code>chillR</code> package uses equations from <a href="https://www.mail-archive.com/sundial@uni-koeln.de/msg01050.html">Spencer (1971)</a> and <a href="https://www.sciencedirect.com/science/article/abs/pii/S0196890404001992">Almorox et al. (2005)</a>. <a href="https://inresgb-lehre.iaas.uni-bonn.de/author/prof.-dr.-eike-luedeling/">Prof. Dr. Eike Lüdeling</a> only needed to understand these equations once to code them into an R function for future use.</p>
<p>Bringing together these functions is similar to how the <code>CH()</code> function was developed and used in the <code>sum_CH</code> function, though the components were more complex. The result is a function that can create realistic daily temperature curves based on the latitude of a location. The provided code illustrates how to use the <code>daylength</code> function to create plots showing sunrise time, sunset time, and daylength for Klein-Altendorf (Latitude: 50.4°N) throughout the year:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="making-hourly-temperatures.html#cb28-1" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">daylength</span>(<span class="at">latitude =</span> <span class="fl">50.4</span>, <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>)</span>
<span id="cb28-2"><a href="making-hourly-temperatures.html#cb28-2" tabindex="-1"></a>Days_df <span class="ot">&lt;-</span></span>
<span id="cb28-3"><a href="making-hourly-temperatures.html#cb28-3" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb28-4"><a href="making-hourly-temperatures.html#cb28-4" tabindex="-1"></a>    <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>,</span>
<span id="cb28-5"><a href="making-hourly-temperatures.html#cb28-5" tabindex="-1"></a>    <span class="at">Sunrise =</span> Days<span class="sc">$</span>Sunrise,</span>
<span id="cb28-6"><a href="making-hourly-temperatures.html#cb28-6" tabindex="-1"></a>    <span class="at">Sunset =</span> Days<span class="sc">$</span>Sunset,</span>
<span id="cb28-7"><a href="making-hourly-temperatures.html#cb28-7" tabindex="-1"></a>    <span class="at">Daylength =</span> Days<span class="sc">$</span>Daylength</span>
<span id="cb28-8"><a href="making-hourly-temperatures.html#cb28-8" tabindex="-1"></a>  )</span>
<span id="cb28-9"><a href="making-hourly-temperatures.html#cb28-9" tabindex="-1"></a>Days_df <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(Days_df, <span class="at">cols =</span> <span class="fu">c</span>(Sunrise<span class="sc">:</span>Daylength))</span>
<span id="cb28-10"><a href="making-hourly-temperatures.html#cb28-10" tabindex="-1"></a></span>
<span id="cb28-11"><a href="making-hourly-temperatures.html#cb28-11" tabindex="-1"></a><span class="fu">ggplot</span>(Days_df, <span class="fu">aes</span>(JDay, value)) <span class="sc">+</span></span>
<span id="cb28-12"><a href="making-hourly-temperatures.html#cb28-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="making-hourly-temperatures.html#cb28-13" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(name)) <span class="sc">+</span></span>
<span id="cb28-14"><a href="making-hourly-temperatures.html#cb28-14" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Time of Day / Daylength (Hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-15"><a href="making-hourly-temperatures.html#cb28-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-1.png" width="80%" height="50%" /></p>
<p>In this context, JDay refers to the Julian Date, which represents the Day of the Year. For example, January 1st is JDay 1, while December 31st is JDay 365 in regular years and JDay 366 in leap years. The <code>ggplot2</code> package is used for creating attractive plots, and the ideal input for it is a data frame. Therefore, the outputs from the <code>daylength()</code> function were first converted into a data frame. Additionally, the three time series - Sunrise, Sunset, and Daylength - were organized into a stacked format using the <code>pivot_longer</code> command from the <code>tidyr</code> package.</p>
<p>The <code>stack_hourly_temps()</code> function in the <code>chillR</code> package integrates these daily dynamics. This function requires a dataset containing daily minimum and maximum temperatures, specifically with columns labeled <code>Tmin</code>, <code>Tmax</code>, <code>Year</code>, <code>Month</code>, and <code>Day</code>. The latitude of the location must also be provided. Using these inputs, the function applies the previously discussed equations to calculate hourly temperatures, and it can also output sunrise and sunset times if desired.</p>
<p>To demonstrate this process, another dataset included with <code>chillR</code>, called <code>KA_weather</code>, will be used. This data frame contains temperature data from the University of Bonn’s experimental station at Klein-Altendorf. The first 10 rows of the <code>KA_weather</code> dataset will be shown for illustration:</p>
<table class="table table-striped table-hover" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Year
</th>
<th style="text-align:center;">
Month
</th>
<th style="text-align:center;">
Day
</th>
<th style="text-align:center;">
Tmax
</th>
<th style="text-align:center;">
Tmin
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
8.2
</td>
<td style="text-align:center;">
5.1
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
9.1
</td>
<td style="text-align:center;">
5.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10.4
</td>
<td style="text-align:center;">
3.3
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
8.4
</td>
<td style="text-align:center;">
4.5
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
12.0
</td>
<td style="text-align:center;">
6.9
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
11.2
</td>
<td style="text-align:center;">
8.6
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
13.9
</td>
<td style="text-align:center;">
8.5
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
14.5
</td>
<td style="text-align:center;">
3.6
</td>
</tr>
</tbody>
</table>
<p>The following process describes how hourly temperatures can be calculated based on the idealized daily temperature curve:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="making-hourly-temperatures.html#cb29-1" tabindex="-1"></a><span class="fu">stack_hourly_temps</span>(KA_weather, <span class="at">latitude =</span> <span class="fl">50.4</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Day
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Tmax
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Tmin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
JDay
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Hour
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Temp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4.844164
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4.746566
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
4.656244
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
4.572187
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
4.493583
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
4.569464
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
5.384001
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
6.139939
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
6.787169
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
7.282787
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
7.593939
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
7.700000
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
7.593939
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
7.282787
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
6.591821
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
6.168074
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
19
</td>
<td style="text-align:center;">
5.870570
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
5.641106
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
5.454280
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
5.296704
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
5.160445
</td>
</tr>
</tbody>
</table>
</div>
<p>And here’s a plot of the data:</p>
<p><img src="bookdownproj_files/figure-html/idealized-1.png" width="80%" height="50%" /></p>
</div>
<div id="empirical-daily-temperature-curves" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Empirical daily temperature curves<a href="making-hourly-temperatures.html#empirical-daily-temperature-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In some locations, idealized daily temperature curves are ineffective, particularly in areas with rugged topography where temperate fruit trees may be shaded for part of the day. For example, in the Jabal Al Akhdar region of Oman, where <a href="https://inresgb-lehre.iaas.uni-bonn.de/author/prof.-dr.-eike-luedeling/">Prof. Dr. Eike Lüdeling</a> initially studied winter chill, various oases in the deeply incised Wadi Muaydin canyon were investigated. Trees near the top of the canyon receive significantly more sunlight than those at the bottom, which is about 1000 meters lower.</p>
<div class="float">
<img src="images/IMG_8487.jpg" alt="Terraced oasis fields at Ash Sharayjah" />
<div class="figcaption"><strong>Terraced oasis fields at Ash Sharayjah</strong></div>
</div>
<p>Even in the absence of mountains, the temperature curve in an orchard may not closely resemble the curve proposed by <a href="https://journals.ashs.org/hortsci/view/journals/hortsci/25/1/article-p14.xml">Linvill (1990)</a> due to its unique microclimate, featuring shaded and sunny spots, dew-covered grass, and bare ground.</p>
<p>In the initial study on Omani oases (<a href="https://link.springer.com/article/10.1007/s10584-009-9581-7">Luedeling et al., 2009b</a>), this issue was not adequately addressed. However, a recent revisit to the location aimed to improve this aspect (<a href="https://link.springer.com/article/10.1007/s10584-020-02862-8">Buerkert et al., 2020</a>).</p>
<p>To analyze the temperature patterns, a dataset of hourly temperature data for the relevant location is needed, ideally covering an entire year or multiple years. For this exercise, the <code>Winters_hours_gaps</code> dataset from a walnut orchard near Winters, California, will be used, as the temperature logger was directly attached to a tree branch, making it unlikely for the data to exactly match the standard daily temperature curve.</p>
<p>The <code>Empirical_daily_temperature_curve()</code> function will be employed to determine the typical hourly temperature patterns for each month of the year, although this method could potentially be enhanced by allowing for continuous analysis instead of monthly breakdowns.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="making-hourly-temperatures.html#cb30-1" tabindex="-1"></a>empi_curve <span class="ot">&lt;-</span> <span class="fu">Empirical_daily_temperature_curve</span>(Winters_hours_gaps)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Hour
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Prediction_coefficient
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.1774859
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0.1550693
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.1285651
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.1145597
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
0.0696064
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
0.0339583
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
0.0313115
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
0.3121959
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
0.4953232
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
0.6819674
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0.8227423
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0.9506491
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
0.9662604
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0.9915996
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
1.0000000
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
0.9490319
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
0.8483098
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
0.6864529
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
19
</td>
<td style="text-align:center;">
0.4945415
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
0.3636642
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
0.2972377
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
0.2360349
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
0.1794802
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.1960789
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0.1407018
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.1283250
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.0819307
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
0.0541415
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
0.0188241
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
0.1697052
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
0.4442722
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
0.5939797
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
0.7363923
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0.8399804
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0.9245702
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
0.9770693
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0.9963131
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
1.0000000
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
0.9568107
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
0.8698369
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
0.7343896
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
19
</td>
<td style="text-align:center;">
0.5330597
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
0.3941038
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
0.3186075
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
0.2594569
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
0.2114486
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="making-hourly-temperatures.html#cb31-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> empi_curve[<span class="dv">1</span><span class="sc">:</span><span class="dv">96</span>, ], <span class="fu">aes</span>(Hour, Prediction_coefficient)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="making-hourly-temperatures.html#cb31-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.3</span>, </span>
<span id="cb31-3"><a href="making-hourly-temperatures.html#cb31-3" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb31-4"><a href="making-hourly-temperatures.html#cb31-4" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(Month)) <span class="sc">+</span> </span>
<span id="cb31-5"><a href="making-hourly-temperatures.html#cb31-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Hour of the day&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="making-hourly-temperatures.html#cb31-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Prediction coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="making-hourly-temperatures.html#cb31-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>The set of coefficients can now be applied to a daily dataset from the same location, allowing for the creation of a reasonable hourly temperature record for the orchard. This is accomplished using the <code>Empirical_hourly_temperatures</code> function, which requires a set of hourly coefficients and a daily temperature record that includes <code>Tmin</code> and <code>Tmax</code> columns.</p>
<p>Additionally, the <code>?</code> operator can be used to access help on how to use any function, such as <code>?Empirical_hourly_temperatures</code>.</p>
<p>The process also involves using the <code>make_all_day_table</code> function, which fills gaps in daily or hourly temperature records and summarizes hourly data into daily minimum and maximum temperatures.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="making-hourly-temperatures.html#cb32-1" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">Empirical_daily_temperature_curve</span>(Winters_hours_gaps)</span>
<span id="cb32-2"><a href="making-hourly-temperatures.html#cb32-2" tabindex="-1"></a>Winters_daily <span class="ot">&lt;-</span></span>
<span id="cb32-3"><a href="making-hourly-temperatures.html#cb32-3" tabindex="-1"></a>  <span class="fu">make_all_day_table</span>(Winters_hours_gaps, <span class="at">input_timestep =</span> <span class="st">&quot;hour&quot;</span>)</span>
<span id="cb32-4"><a href="making-hourly-temperatures.html#cb32-4" tabindex="-1"></a>Winters_hours <span class="ot">&lt;-</span> <span class="fu">Empirical_hourly_temperatures</span>(Winters_daily, coeffs)</span></code></pre></div>
<p>The next step is to plot the results to visualize the hourly temperature data. This allows for a comparison between the results from the empirical method, the triangular function, and the idealized temperature curve. Additionally, actual observed temperatures will be used to validate the results. To facilitate this process, the data will first be simplified for easier handling:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="making-hourly-temperatures.html#cb33-1" tabindex="-1"></a>Winters_hours <span class="ot">&lt;-</span> Winters_hours[, <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>, <span class="st">&quot;Temp&quot;</span>)]</span>
<span id="cb33-2"><a href="making-hourly-temperatures.html#cb33-2" tabindex="-1"></a><span class="fu">colnames</span>(Winters_hours)[<span class="fu">ncol</span>(Winters_hours)] <span class="ot">&lt;-</span> <span class="st">&quot;Temp_empirical&quot;</span></span>
<span id="cb33-3"><a href="making-hourly-temperatures.html#cb33-3" tabindex="-1"></a>Winters_ideal <span class="ot">&lt;-</span></span>
<span id="cb33-4"><a href="making-hourly-temperatures.html#cb33-4" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(Winters_daily, <span class="at">latitude =</span> <span class="fl">38.5</span>)<span class="sc">$</span>hourtemps</span>
<span id="cb33-5"><a href="making-hourly-temperatures.html#cb33-5" tabindex="-1"></a>Winters_ideal <span class="ot">&lt;-</span> Winters_ideal[, <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>, <span class="st">&quot;Temp&quot;</span>)]</span>
<span id="cb33-6"><a href="making-hourly-temperatures.html#cb33-6" tabindex="-1"></a><span class="fu">colnames</span>(Winters_ideal)[<span class="fu">ncol</span>(Winters_ideal)] <span class="ot">&lt;-</span> <span class="st">&quot;Temp_ideal&quot;</span></span></code></pre></div>
<p>The next step involves creating the ‘triangular’ dataset. Understanding the process behind this construction is essential.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="making-hourly-temperatures.html#cb34-1" tabindex="-1"></a>Winters_triangle <span class="ot">&lt;-</span> Winters_daily</span>
<span id="cb34-2"><a href="making-hourly-temperatures.html#cb34-2" tabindex="-1"></a>Winters_triangle[, <span class="st">&quot;Hour&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-3"><a href="making-hourly-temperatures.html#cb34-3" tabindex="-1"></a>Winters_triangle<span class="sc">$</span>Hour[<span class="fu">nrow</span>(Winters_triangle)] <span class="ot">&lt;-</span> <span class="dv">23</span></span>
<span id="cb34-4"><a href="making-hourly-temperatures.html#cb34-4" tabindex="-1"></a>Winters_triangle[, <span class="st">&quot;Temp&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-5"><a href="making-hourly-temperatures.html#cb34-5" tabindex="-1"></a>Winters_triangle <span class="ot">&lt;-</span></span>
<span id="cb34-6"><a href="making-hourly-temperatures.html#cb34-6" tabindex="-1"></a>  <span class="fu">make_all_day_table</span>(Winters_triangle, <span class="at">timestep =</span> <span class="st">&quot;hour&quot;</span>)</span>
<span id="cb34-7"><a href="making-hourly-temperatures.html#cb34-7" tabindex="-1"></a><span class="fu">colnames</span>(Winters_triangle)[<span class="fu">ncol</span>(Winters_triangle)] <span class="ot">&lt;-</span></span>
<span id="cb34-8"><a href="making-hourly-temperatures.html#cb34-8" tabindex="-1"></a>  <span class="st">&quot;Temp_triangular&quot;</span></span>
<span id="cb34-9"><a href="making-hourly-temperatures.html#cb34-9" tabindex="-1"></a></span>
<span id="cb34-10"><a href="making-hourly-temperatures.html#cb34-10" tabindex="-1"></a><span class="co"># with the following loop, we fill in the daily Tmin and Tmax values for every</span></span>
<span id="cb34-11"><a href="making-hourly-temperatures.html#cb34-11" tabindex="-1"></a><span class="co"># hour of the dataset</span></span>
<span id="cb34-12"><a href="making-hourly-temperatures.html#cb34-12" tabindex="-1"></a></span>
<span id="cb34-13"><a href="making-hourly-temperatures.html#cb34-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(Winters_triangle))</span>
<span id="cb34-14"><a href="making-hourly-temperatures.html#cb34-14" tabindex="-1"></a>{</span>
<span id="cb34-15"><a href="making-hourly-temperatures.html#cb34-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Winters_triangle<span class="sc">$</span>Tmin[i]))</span>
<span id="cb34-16"><a href="making-hourly-temperatures.html#cb34-16" tabindex="-1"></a>    Winters_triangle<span class="sc">$</span>Tmin[i] <span class="ot">&lt;-</span> Winters_triangle<span class="sc">$</span>Tmin[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb34-17"><a href="making-hourly-temperatures.html#cb34-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Winters_triangle<span class="sc">$</span>Tmax[i]))</span>
<span id="cb34-18"><a href="making-hourly-temperatures.html#cb34-18" tabindex="-1"></a>    Winters_triangle<span class="sc">$</span>Tmax[i] <span class="ot">&lt;-</span> Winters_triangle<span class="sc">$</span>Tmax[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb34-19"><a href="making-hourly-temperatures.html#cb34-19" tabindex="-1"></a>}</span>
<span id="cb34-20"><a href="making-hourly-temperatures.html#cb34-20" tabindex="-1"></a>Winters_triangle<span class="sc">$</span>Temp_triangular <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb34-21"><a href="making-hourly-temperatures.html#cb34-21" tabindex="-1"></a></span>
<span id="cb34-22"><a href="making-hourly-temperatures.html#cb34-22" tabindex="-1"></a><span class="co"># now we assign the daily Tmin value to the 6th hour of every day</span></span>
<span id="cb34-23"><a href="making-hourly-temperatures.html#cb34-23" tabindex="-1"></a></span>
<span id="cb34-24"><a href="making-hourly-temperatures.html#cb34-24" tabindex="-1"></a>Winters_triangle<span class="sc">$</span>Temp_triangular[<span class="fu">which</span>(Winters_triangle<span class="sc">$</span>Hour <span class="sc">==</span> <span class="dv">6</span>)] <span class="ot">&lt;-</span></span>
<span id="cb34-25"><a href="making-hourly-temperatures.html#cb34-25" tabindex="-1"></a>  Winters_triangle<span class="sc">$</span>Tmin[<span class="fu">which</span>(Winters_triangle<span class="sc">$</span>Hour <span class="sc">==</span> <span class="dv">6</span>)]</span>
<span id="cb34-26"><a href="making-hourly-temperatures.html#cb34-26" tabindex="-1"></a></span>
<span id="cb34-27"><a href="making-hourly-temperatures.html#cb34-27" tabindex="-1"></a><span class="co"># we also assign the daily Tmax value to the 18th hour of every day</span></span>
<span id="cb34-28"><a href="making-hourly-temperatures.html#cb34-28" tabindex="-1"></a></span>
<span id="cb34-29"><a href="making-hourly-temperatures.html#cb34-29" tabindex="-1"></a>Winters_triangle<span class="sc">$</span>Temp_triangular[<span class="fu">which</span>(Winters_triangle<span class="sc">$</span>Hour <span class="sc">==</span> <span class="dv">18</span>)] <span class="ot">&lt;-</span></span>
<span id="cb34-30"><a href="making-hourly-temperatures.html#cb34-30" tabindex="-1"></a>  Winters_triangle<span class="sc">$</span>Tmax[<span class="fu">which</span>(Winters_triangle<span class="sc">$</span>Hour <span class="sc">==</span> <span class="dv">18</span>)]</span>
<span id="cb34-31"><a href="making-hourly-temperatures.html#cb34-31" tabindex="-1"></a></span>
<span id="cb34-32"><a href="making-hourly-temperatures.html#cb34-32" tabindex="-1"></a><span class="co"># in the following step, we use the chillR function &quot;interpolate_gaps&quot;</span></span>
<span id="cb34-33"><a href="making-hourly-temperatures.html#cb34-33" tabindex="-1"></a><span class="co"># to fill in all the gaps in the hourly record with straight lines</span></span>
<span id="cb34-34"><a href="making-hourly-temperatures.html#cb34-34" tabindex="-1"></a></span>
<span id="cb34-35"><a href="making-hourly-temperatures.html#cb34-35" tabindex="-1"></a>Winters_triangle<span class="sc">$</span>Temp_triangular <span class="ot">&lt;-</span></span>
<span id="cb34-36"><a href="making-hourly-temperatures.html#cb34-36" tabindex="-1"></a>  <span class="fu">interpolate_gaps</span>(Winters_triangle<span class="sc">$</span>Temp_triangular)<span class="sc">$</span>interp</span>
<span id="cb34-37"><a href="making-hourly-temperatures.html#cb34-37" tabindex="-1"></a>Winters_triangle <span class="ot">&lt;-</span></span>
<span id="cb34-38"><a href="making-hourly-temperatures.html#cb34-38" tabindex="-1"></a>  Winters_triangle[, <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>, <span class="st">&quot;Temp_triangular&quot;</span>)]</span></code></pre></div>
<p>The next step is to merge all the data frames to facilitate easier display and comparison of the datasets.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="making-hourly-temperatures.html#cb35-1" tabindex="-1"></a>Winters_temps <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="making-hourly-temperatures.html#cb35-2" tabindex="-1"></a>  <span class="fu">merge</span>(Winters_hours_gaps,</span>
<span id="cb35-3"><a href="making-hourly-temperatures.html#cb35-3" tabindex="-1"></a>        Winters_hours,</span>
<span id="cb35-4"><a href="making-hourly-temperatures.html#cb35-4" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>))</span>
<span id="cb35-5"><a href="making-hourly-temperatures.html#cb35-5" tabindex="-1"></a>Winters_temps <span class="ot">&lt;-</span></span>
<span id="cb35-6"><a href="making-hourly-temperatures.html#cb35-6" tabindex="-1"></a>  <span class="fu">merge</span>(Winters_temps,</span>
<span id="cb35-7"><a href="making-hourly-temperatures.html#cb35-7" tabindex="-1"></a>        Winters_triangle,</span>
<span id="cb35-8"><a href="making-hourly-temperatures.html#cb35-8" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>))</span>
<span id="cb35-9"><a href="making-hourly-temperatures.html#cb35-9" tabindex="-1"></a>Winters_temps <span class="ot">&lt;-</span></span>
<span id="cb35-10"><a href="making-hourly-temperatures.html#cb35-10" tabindex="-1"></a>  <span class="fu">merge</span>(Winters_temps,</span>
<span id="cb35-11"><a href="making-hourly-temperatures.html#cb35-11" tabindex="-1"></a>        Winters_ideal,</span>
<span id="cb35-12"><a href="making-hourly-temperatures.html#cb35-12" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>))</span></code></pre></div>
<p>The dataset now includes observed temperatures along with the three approximations: triangular, idealized curve, and empirical curve. To plot this data effectively, the <code>Year</code>, <code>Month</code>, <code>Day</code>, and <code>Hour</code> columns will be converted into R’s date format using <code>ISOdate</code>, and the data frame will be reorganized for better usability.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="making-hourly-temperatures.html#cb36-1" tabindex="-1"></a>Winters_temps[, <span class="st">&quot;DATE&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb36-2"><a href="making-hourly-temperatures.html#cb36-2" tabindex="-1"></a>  <span class="fu">ISOdate</span>(Winters_temps<span class="sc">$</span>Year,</span>
<span id="cb36-3"><a href="making-hourly-temperatures.html#cb36-3" tabindex="-1"></a>          Winters_temps<span class="sc">$</span>Month,</span>
<span id="cb36-4"><a href="making-hourly-temperatures.html#cb36-4" tabindex="-1"></a>          Winters_temps<span class="sc">$</span>Day,</span>
<span id="cb36-5"><a href="making-hourly-temperatures.html#cb36-5" tabindex="-1"></a>          Winters_temps<span class="sc">$</span>Hour)</span>
<span id="cb36-6"><a href="making-hourly-temperatures.html#cb36-6" tabindex="-1"></a></span>
<span id="cb36-7"><a href="making-hourly-temperatures.html#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="making-hourly-temperatures.html#cb36-8" tabindex="-1"></a>Winters_temps_to_plot <span class="ot">&lt;-</span></span>
<span id="cb36-9"><a href="making-hourly-temperatures.html#cb36-9" tabindex="-1"></a>  Winters_temps[, <span class="fu">c</span>(<span class="st">&quot;DATE&quot;</span>,</span>
<span id="cb36-10"><a href="making-hourly-temperatures.html#cb36-10" tabindex="-1"></a>                    <span class="st">&quot;Temp&quot;</span>,</span>
<span id="cb36-11"><a href="making-hourly-temperatures.html#cb36-11" tabindex="-1"></a>                    <span class="st">&quot;Temp_empirical&quot;</span>,</span>
<span id="cb36-12"><a href="making-hourly-temperatures.html#cb36-12" tabindex="-1"></a>                    <span class="st">&quot;Temp_triangular&quot;</span>,</span>
<span id="cb36-13"><a href="making-hourly-temperatures.html#cb36-13" tabindex="-1"></a>                    <span class="st">&quot;Temp_ideal&quot;</span>)]</span>
<span id="cb36-14"><a href="making-hourly-temperatures.html#cb36-14" tabindex="-1"></a>Winters_temps_to_plot <span class="ot">&lt;-</span> Winters_temps_to_plot[<span class="dv">100</span><span class="sc">:</span><span class="dv">200</span>, ]</span>
<span id="cb36-15"><a href="making-hourly-temperatures.html#cb36-15" tabindex="-1"></a>Winters_temps_to_plot <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(Winters_temps_to_plot, <span class="at">cols=</span>Temp<span class="sc">:</span>Temp_ideal)</span>
<span id="cb36-16"><a href="making-hourly-temperatures.html#cb36-16" tabindex="-1"></a><span class="fu">colnames</span>(Winters_temps_to_plot) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DATE&quot;</span>, <span class="st">&quot;Method&quot;</span>, <span class="st">&quot;Temperature&quot;</span>)</span>
<span id="cb36-17"><a href="making-hourly-temperatures.html#cb36-17" tabindex="-1"></a></span>
<span id="cb36-18"><a href="making-hourly-temperatures.html#cb36-18" tabindex="-1"></a></span>
<span id="cb36-19"><a href="making-hourly-temperatures.html#cb36-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Winters_temps_to_plot, <span class="fu">aes</span>(DATE, Temperature, <span class="at">colour =</span> Method)) <span class="sc">+</span></span>
<span id="cb36-20"><a href="making-hourly-temperatures.html#cb36-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.3</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Temperature (°C)&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>The plot indicates that the triangular curve deviates significantly from the observed data, while the <code>Temp_empirical</code> and <code>Temp_ideal</code> curves appear quite similar and are difficult to differentiate.</p>
<p>To compare these curves more thoroughly, the Root Mean Square Error (RMSE) can be calculated, as it is useful for quantifying the alignment between predicted and observed values. The <code>chillR</code> package includes a function to perform this calculation.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="making-hourly-temperatures.html#cb37-1" tabindex="-1"></a><span class="co"># here&#39;s the RMSE for the triangular method:</span></span>
<span id="cb37-2"><a href="making-hourly-temperatures.html#cb37-2" tabindex="-1"></a><span class="fu">RMSEP</span>(Winters_temps<span class="sc">$</span>Temp_triangular, Winters_temps<span class="sc">$</span>Temp)</span></code></pre></div>
<pre><code>## [1] 4.695289</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="making-hourly-temperatures.html#cb39-1" tabindex="-1"></a><span class="co"># here&#39;s the RMSE for the idealized-curve method:</span></span>
<span id="cb39-2"><a href="making-hourly-temperatures.html#cb39-2" tabindex="-1"></a><span class="fu">RMSEP</span>(Winters_temps<span class="sc">$</span>Temp_ideal, Winters_temps<span class="sc">$</span>Temp)</span></code></pre></div>
<pre><code>## [1] 1.630714</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="making-hourly-temperatures.html#cb41-1" tabindex="-1"></a><span class="co"># and here&#39;s the RMSE for the empirical-curve method:</span></span>
<span id="cb41-2"><a href="making-hourly-temperatures.html#cb41-2" tabindex="-1"></a><span class="fu">RMSEP</span>(Winters_temps<span class="sc">$</span>Temp_empirical, Winters_temps<span class="sc">$</span>Temp)</span></code></pre></div>
<pre><code>## [1] 1.410625</code></pre>
<p>The results show an RMSE of 4.7 for the triangular method, 1.63 for the idealized curve method, and 1.41 for the empirical curve method. Since a lower RMSE indicates better accuracy, these results demonstrate that calibrating the prediction function with observed hourly data significantly improves accuracy, especially compared to the triangular method.</p>
<p>While it might be questioned how much this affects chill accumulation modeling, it is often found to make a considerable difference.</p>
</div>
<div id="exercises-on-hourly-temperatures" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> <code>Exercises</code> on hourly temperatures<a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><em>Choose a location of interest, find out its latitude and produce plots of daily sunrise, sunset and daylength.</em></li>
</ol>
<p>The Yakima Valley in Washington State, USA, is located at about 46.6° N latitude. This region has a continental climate with cold winters and hot, dry summers, creating ideal conditions for growing fruit trees. The valley is well known for producing a variety of fruits, including apples, cherries, pears, and grapes, which benefit from its distinct seasonal changes. Using the <code>daylength()</code> function, you could create plots showing daily sunrise, sunset, and day length times.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="making-hourly-temperatures.html#cb43-1" tabindex="-1"></a>Yakima <span class="ot">&lt;-</span> <span class="fu">daylength</span>(<span class="at">latitude =</span> <span class="fl">46.6</span>, <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>)</span>
<span id="cb43-2"><a href="making-hourly-temperatures.html#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="making-hourly-temperatures.html#cb43-3" tabindex="-1"></a>Yakima_df <span class="ot">&lt;-</span></span>
<span id="cb43-4"><a href="making-hourly-temperatures.html#cb43-4" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb43-5"><a href="making-hourly-temperatures.html#cb43-5" tabindex="-1"></a>    <span class="at">JDay =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>,</span>
<span id="cb43-6"><a href="making-hourly-temperatures.html#cb43-6" tabindex="-1"></a>    <span class="at">Sunrise =</span> Yakima<span class="sc">$</span>Sunrise,</span>
<span id="cb43-7"><a href="making-hourly-temperatures.html#cb43-7" tabindex="-1"></a>    <span class="at">Sunset =</span> Yakima<span class="sc">$</span>Sunset,</span>
<span id="cb43-8"><a href="making-hourly-temperatures.html#cb43-8" tabindex="-1"></a>    <span class="at">Daylength =</span> Yakima<span class="sc">$</span>Daylength</span>
<span id="cb43-9"><a href="making-hourly-temperatures.html#cb43-9" tabindex="-1"></a>  )</span>
<span id="cb43-10"><a href="making-hourly-temperatures.html#cb43-10" tabindex="-1"></a></span>
<span id="cb43-11"><a href="making-hourly-temperatures.html#cb43-11" tabindex="-1"></a>Yakima_df_longer <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(Yakima_df, <span class="at">cols =</span> <span class="fu">c</span>(Sunrise<span class="sc">:</span>Daylength))</span>
<span id="cb43-12"><a href="making-hourly-temperatures.html#cb43-12" tabindex="-1"></a></span>
<span id="cb43-13"><a href="making-hourly-temperatures.html#cb43-13" tabindex="-1"></a><span class="fu">ggplot</span>(Yakima_df_longer, <span class="fu">aes</span>(JDay, value)) <span class="sc">+</span></span>
<span id="cb43-14"><a href="making-hourly-temperatures.html#cb43-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb43-15"><a href="making-hourly-temperatures.html#cb43-15" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(name)) <span class="sc">+</span></span>
<span id="cb43-16"><a href="making-hourly-temperatures.html#cb43-16" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Time of Day / Daylength (Hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-17"><a href="making-hourly-temperatures.html#cb43-17" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li><em>Produce an hourly dataset, based on idealized daily curves, for the</em> <code>KA_weather</code> <em>dataset</em> <em>(included in</em> <code>chillR</code><em>)</em></li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="making-hourly-temperatures.html#cb44-1" tabindex="-1"></a>KA_hourly <span class="ot">&lt;-</span> <span class="fu">stack_hourly_temps</span>(KA_weather, <span class="at">latitude =</span> <span class="fl">50.4</span>)</span></code></pre></div>
<p>Based on idealized daily curves, the hourly dataset for Julian Day 6 (January 6th) is shown below:</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; ">
<table class="table table-striped" style="font-size: 15px; color: black; ">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Day
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Tmax
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Tmin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
JDay
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Hour
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Temp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
4.990741
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4.881232
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4.782253
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4.691956
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4.608939
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
4.532117
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
4.460628
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
4.393780
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
4.491337
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
5.430950
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
6.302486
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
7.048391
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
7.619410
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
7.977836
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
8.100000
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
7.977836
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
7.619410
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
7.419674
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
7.318918
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
19
</td>
<td style="text-align:center;">
7.248287
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
7.193854
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
7.149557
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
7.112208
</td>
</tr>
<tr>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
4.4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
7.079920
</td>
</tr>
</tbody>
</table>
</div>
<ol start="3" style="list-style-type: decimal">
<li><em>Produce empirical temperature curve parameters for the</em> <code>Winters_hours_gaps</code> <em>dataset, and use them to predict hourly values from daily temperatures (this is very similar to the example above, but please make sure you understand what’s going on).</em></li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="making-hourly-temperatures.html#cb45-1" tabindex="-1"></a><span class="co"># Generating empirical daily temperature curve from observed hourly data</span></span>
<span id="cb45-2"><a href="making-hourly-temperatures.html#cb45-2" tabindex="-1"></a>empi_curve <span class="ot">&lt;-</span> <span class="fu">Empirical_daily_temperature_curve</span>(Winters_hours_gaps)</span>
<span id="cb45-3"><a href="making-hourly-temperatures.html#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="making-hourly-temperatures.html#cb45-4" tabindex="-1"></a><span class="co"># Filling gaps in daily or hourly temperature data</span></span>
<span id="cb45-5"><a href="making-hourly-temperatures.html#cb45-5" tabindex="-1"></a>Winters_daily <span class="ot">&lt;-</span> <span class="fu">make_all_day_table</span>(Winters_hours_gaps, <span class="at">input_timestep =</span> <span class="st">&quot;hour&quot;</span>)</span>
<span id="cb45-6"><a href="making-hourly-temperatures.html#cb45-6" tabindex="-1"></a></span>
<span id="cb45-7"><a href="making-hourly-temperatures.html#cb45-7" tabindex="-1"></a><span class="co"># Using empirical coefficients to predict hourly temperatures based on daily temperatures</span></span>
<span id="cb45-8"><a href="making-hourly-temperatures.html#cb45-8" tabindex="-1"></a>Winters_hours <span class="ot">&lt;-</span> <span class="fu">Empirical_hourly_temperatures</span>(Winters_daily, empi_curve)</span>
<span id="cb45-9"><a href="making-hourly-temperatures.html#cb45-9" tabindex="-1"></a></span>
<span id="cb45-10"><a href="making-hourly-temperatures.html#cb45-10" tabindex="-1"></a><span class="co"># Make an empirical dataset </span></span>
<span id="cb45-11"><a href="making-hourly-temperatures.html#cb45-11" tabindex="-1"></a>Winters_hours <span class="ot">&lt;-</span> Winters_hours[, <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>, <span class="st">&quot;Temp&quot;</span>)]</span>
<span id="cb45-12"><a href="making-hourly-temperatures.html#cb45-12" tabindex="-1"></a><span class="fu">colnames</span>(Winters_hours)[<span class="fu">ncol</span>(Winters_hours)] <span class="ot">&lt;-</span> <span class="st">&quot;Temp_empirical&quot;</span></span>
<span id="cb45-13"><a href="making-hourly-temperatures.html#cb45-13" tabindex="-1"></a></span>
<span id="cb45-14"><a href="making-hourly-temperatures.html#cb45-14" tabindex="-1"></a><span class="co"># Merge data frames</span></span>
<span id="cb45-15"><a href="making-hourly-temperatures.html#cb45-15" tabindex="-1"></a>Winters_temps <span class="ot">&lt;-</span></span>
<span id="cb45-16"><a href="making-hourly-temperatures.html#cb45-16" tabindex="-1"></a>  <span class="fu">merge</span>(Winters_hours_gaps,</span>
<span id="cb45-17"><a href="making-hourly-temperatures.html#cb45-17" tabindex="-1"></a>        Winters_hours,</span>
<span id="cb45-18"><a href="making-hourly-temperatures.html#cb45-18" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="making-hourly-temperatures.html#cb46-1" tabindex="-1"></a><span class="co"># Covert Year, Month, Day and Hour columns into R&#39;s date formate and reorganizing the data frame</span></span>
<span id="cb46-2"><a href="making-hourly-temperatures.html#cb46-2" tabindex="-1"></a>Winters_temps[, <span class="st">&quot;DATE&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb46-3"><a href="making-hourly-temperatures.html#cb46-3" tabindex="-1"></a>  <span class="fu">ISOdate</span>(Winters_temps<span class="sc">$</span>Year,</span>
<span id="cb46-4"><a href="making-hourly-temperatures.html#cb46-4" tabindex="-1"></a>          Winters_temps<span class="sc">$</span>Month,</span>
<span id="cb46-5"><a href="making-hourly-temperatures.html#cb46-5" tabindex="-1"></a>          Winters_temps<span class="sc">$</span>Day,</span>
<span id="cb46-6"><a href="making-hourly-temperatures.html#cb46-6" tabindex="-1"></a>          Winters_temps<span class="sc">$</span>Hour)</span>
<span id="cb46-7"><a href="making-hourly-temperatures.html#cb46-7" tabindex="-1"></a></span>
<span id="cb46-8"><a href="making-hourly-temperatures.html#cb46-8" tabindex="-1"></a>Winters_temps_to_plot <span class="ot">&lt;-</span></span>
<span id="cb46-9"><a href="making-hourly-temperatures.html#cb46-9" tabindex="-1"></a>  Winters_temps[, <span class="fu">c</span>(<span class="st">&quot;DATE&quot;</span>,</span>
<span id="cb46-10"><a href="making-hourly-temperatures.html#cb46-10" tabindex="-1"></a>                    <span class="st">&quot;Temp&quot;</span>,</span>
<span id="cb46-11"><a href="making-hourly-temperatures.html#cb46-11" tabindex="-1"></a>                    <span class="st">&quot;Temp_empirical&quot;</span>)]</span>
<span id="cb46-12"><a href="making-hourly-temperatures.html#cb46-12" tabindex="-1"></a>Winters_temps_to_plot <span class="ot">&lt;-</span> Winters_temps_to_plot[<span class="dv">100</span><span class="sc">:</span><span class="dv">200</span>, ]</span>
<span id="cb46-13"><a href="making-hourly-temperatures.html#cb46-13" tabindex="-1"></a>Winters_temps_to_plot <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(Winters_temps_to_plot, <span class="at">cols=</span>Temp<span class="sc">:</span>Temp_empirical)</span>
<span id="cb46-14"><a href="making-hourly-temperatures.html#cb46-14" tabindex="-1"></a><span class="fu">colnames</span>(Winters_temps_to_plot) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DATE&quot;</span>, <span class="st">&quot;Method&quot;</span>, <span class="st">&quot;Temperature&quot;</span>)</span>
<span id="cb46-15"><a href="making-hourly-temperatures.html#cb46-15" tabindex="-1"></a></span>
<span id="cb46-16"><a href="making-hourly-temperatures.html#cb46-16" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Winters_temps_to_plot, <span class="fu">aes</span>(DATE, Temperature, <span class="at">colour =</span> Method)) <span class="sc">+</span></span>
<span id="cb46-17"><a href="making-hourly-temperatures.html#cb46-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.3</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Temperature (°C)&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chill.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="some-useful-tools-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/edit/main/08-making_temp.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/blob/main/08-making_temp.Rmd",
"text": null
},
"download": ["bookdownproj.pdf", "bookdownproj.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"fig_caption": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
