<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Filling gaps in temperature records | Tree phenology analysis with R</title>
  <meta name="description" content="Chapter 10 Filling gaps in temperature records | Tree phenology analysis with R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Filling gaps in temperature records | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Filling gaps in temperature records | Tree phenology analysis with R" />
  
  
  

<meta name="author" content="Jacqueline Wingen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="some-useful-tools-in-r.html"/>
<link rel="next" href="getting-temperature-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Analysis with R</a></li>
<li><a href="index.html"><img src="images/chillR_hexSticker.png" width="75%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the Module</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> Git and Github</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="3.6" data-path="tree-dormancy.html"><a href="tree-dormancy.html#excercises-on-tree-dormancy"><i class="fa fa-check"></i><b>3.6</b> <code>Excercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#whats-already-known"><i class="fa fa-check"></i><b>4.2</b> Whatâ€™s already known</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projections-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projections approaches</a></li>
<li class="chapter" data-level="4.5" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises-on-climate-change"><i class="fa fa-check"></i><b>4.5</b> <code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.2</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.3</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.4</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.5</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.6</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.7</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.8</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.9</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.10</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.11</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.12</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.13</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.14" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises-on-past-chill-projections"><i class="fa fa-check"></i><b>5.14</b> <code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill.html"><a href="manual-chill.html"><i class="fa fa-check"></i><b>6</b> Manual chill</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill.html"><a href="manual-chill.html#learning-goals-3"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill.html"><a href="manual-chill.html#chilling-hours-calculation-using-chillr"><i class="fa fa-check"></i><b>6.2</b> Chilling hours calculation using chillR</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="manual-chill.html"><a href="manual-chill.html#data-requirements"><i class="fa fa-check"></i><b>6.2.1</b> <strong>Data Requirements</strong></a></li>
<li class="chapter" data-level="6.2.2" data-path="manual-chill.html"><a href="manual-chill.html#loading-and-preparing-data"><i class="fa fa-check"></i><b>6.2.2</b> Loading and Preparing Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="manual-chill.html"><a href="manual-chill.html#manual-calculation-of-chilling-hours"><i class="fa fa-check"></i><b>6.2.3</b> <strong>Manual Calculation of Chilling Hours</strong></a></li>
<li class="chapter" data-level="6.2.4" data-path="manual-chill.html"><a href="manual-chill.html#automation-with-functions"><i class="fa fa-check"></i><b>6.2.4</b> Automation with Functions</a></li>
<li class="chapter" data-level="6.2.5" data-path="manual-chill.html"><a href="manual-chill.html#application-example"><i class="fa fa-check"></i><b>6.2.5</b> Application Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manual-chill.html"><a href="manual-chill.html#exercises-on-basic-chill-modeling"><i class="fa fa-check"></i><b>6.3</b> <code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill.html"><a href="chill.html"><i class="fa fa-check"></i><b>7</b> Chill</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill.html"><a href="chill.html#learning-goals-4"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="chill.html"><a href="chill.html#chilling_hours-function"><i class="fa fa-check"></i><b>7.2</b> <code>Chilling_Hours()</code> function</a></li>
<li class="chapter" data-level="7.3" data-path="chill.html"><a href="chill.html#utah-model"><i class="fa fa-check"></i><b>7.3</b> Utah Model</a></li>
<li class="chapter" data-level="7.4" data-path="chill.html"><a href="chill.html#creating-custom-chill-models-with-step_model"><i class="fa fa-check"></i><b>7.4</b> Creating Custom Chill Models with <code>step_model()</code></a></li>
<li class="chapter" data-level="7.5" data-path="chill.html"><a href="chill.html#dynamic-model"><i class="fa fa-check"></i><b>7.5</b> Dynamic model</a></li>
<li class="chapter" data-level="7.6" data-path="chill.html"><a href="chill.html#chilling-and-tempresponse-functions"><i class="fa fa-check"></i><b>7.6</b> <code>Chilling</code> and <code>tempResponse</code> functions</a></li>
<li class="chapter" data-level="7.7" data-path="chill.html"><a href="chill.html#exercises-on-chill-models"><i class="fa fa-check"></i><b>7.7</b> <code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#learning-goals-5"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.2</b> Generating hourly temperatures</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.3</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.4" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.4</b> Empirical daily temperature curves</a></li>
<li class="chapter" data-level="8.5" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures"><i class="fa fa-check"></i><b>8.5</b> <code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#learning-goals-6"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.2</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.3</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.4</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.5</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.6</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.7</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.7.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.7.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.7.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.7.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.7.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.7.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.7.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.7.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.7.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.7.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.8</b> Loops</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.8.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.8.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.9</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.9.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.9.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.9.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises-on-useful-r-tools"><i class="fa fa-check"></i><b>9.10</b> <code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>10</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="10.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#learning-goals-7"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#gaps"><i class="fa fa-check"></i><b>10.2</b> Gaps</a></li>
<li class="chapter" data-level="10.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records"><i class="fa fa-check"></i><b>10.3</b> Filling short gaps in daily records</a></li>
<li class="chapter" data-level="10.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records"><i class="fa fa-check"></i><b>10.4</b> Filling long gaps in daily records</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals"><i class="fa fa-check"></i><b>10.4.1</b> Bias-correction for shorter intervals</a></li>
<li class="chapter" data-level="10.4.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later"><i class="fa fa-check"></i><b>10.4.2</b> Saving the data for later</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#exercises-on-filling-gaps"><i class="fa fa-check"></i><b>10.5</b> <code>Exercises</code> on filling gaps</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>11</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>11.1</b> Learning goals for this lesson</a></li>
<li class="chapter" data-level="11.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#temperature-data-needs"><i class="fa fa-check"></i><b>11.2</b> Temperature data needs</a></li>
<li class="chapter" data-level="11.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>11.3</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actionlist_stations"><i class="fa fa-check"></i><b>11.3.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="11.3.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actiondownload_weather"><i class="fa fa-check"></i><b>11.3.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>11.3.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#exercises-on-getting-temperature-data"><i class="fa fa-check"></i><b>11.4</b> <code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="filling-gaps-in-temperature-records" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Filling gaps in temperature records<a href="filling-gaps-in-temperature-records.html#filling-gaps-in-temperature-records" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-7" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Learning goals<a href="filling-gaps-in-temperature-records.html#learning-goals-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>see why having gaps in records can be quite problematic</li>
<li>learn about simple ways to fill gaps in daily temperature records</li>
<li>learn how to use data from auxiliary weather stations to fill gaps in daily temperature records</li>
<li>learn about a creative way to close gaps in hourly temperature records</li>
</ul>
</div>
<div id="gaps" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Gaps<a href="filling-gaps-in-temperature-records.html#gaps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is a wealth of weather data, but it often contains gaps due to issues like equipment malfunctions, power outages, and storage problems. These gaps pose challenges for modeling agroclimatic conditions, as many scientific methods struggle with missing data. Therefore, effective gap-filling methods are necessary.</p>
</div>
<div id="filling-short-gaps-in-daily-records" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Filling short gaps in daily records<a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Weather records are mostly complete, though some daily maximum or minimum temperatures may be missing. For short gaps, simple linear interpolation can estimate values by averaging the last known and first known measurements around the gap. This approach can work for gaps of 2-3 days, though accuracy declines with longer gaps. For extended absences of several weeks or more, linear interpolation may miss significant temperature trends, and for gaps as long as a year, it could entirely overlook seasonal patterns, leading to large errors. Nonetheless, the <code>chillR</code> package provides a function, <code>interpolate_gaps()</code>, to perform this basic interpolation:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="filling-gaps-in-temperature-records.html#cb114-1" tabindex="-1"></a>weather <span class="ot">&lt;-</span> KA_weather <span class="sc">%&gt;%</span> <span class="fu">make_all_day_table</span>()</span>
<span id="cb114-2"><a href="filling-gaps-in-temperature-records.html#cb114-2" tabindex="-1"></a></span>
<span id="cb114-3"><a href="filling-gaps-in-temperature-records.html#cb114-3" tabindex="-1"></a>Tmin_int <span class="ot">&lt;-</span> <span class="fu">interpolate_gaps</span>(weather[,<span class="st">&quot;Tmin&quot;</span>])</span>
<span id="cb114-4"><a href="filling-gaps-in-temperature-records.html#cb114-4" tabindex="-1"></a></span>
<span id="cb114-5"><a href="filling-gaps-in-temperature-records.html#cb114-5" tabindex="-1"></a>weather <span class="ot">&lt;-</span> weather <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Tmin =</span> Tmin_int<span class="sc">$</span>interp,</span>
<span id="cb114-6"><a href="filling-gaps-in-temperature-records.html#cb114-6" tabindex="-1"></a>                              <span class="at">Tmin_interpolated =</span> Tmin_int<span class="sc">$</span>missing)</span>
<span id="cb114-7"><a href="filling-gaps-in-temperature-records.html#cb114-7" tabindex="-1"></a></span>
<span id="cb114-8"><a href="filling-gaps-in-temperature-records.html#cb114-8" tabindex="-1"></a>Tmax_int <span class="ot">&lt;-</span> <span class="fu">interpolate_gaps</span>(weather[,<span class="st">&quot;Tmax&quot;</span>])</span>
<span id="cb114-9"><a href="filling-gaps-in-temperature-records.html#cb114-9" tabindex="-1"></a></span>
<span id="cb114-10"><a href="filling-gaps-in-temperature-records.html#cb114-10" tabindex="-1"></a>weather <span class="ot">&lt;-</span> weather <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Tmax =</span> Tmax_int<span class="sc">$</span>interp,</span>
<span id="cb114-11"><a href="filling-gaps-in-temperature-records.html#cb114-11" tabindex="-1"></a>                              <span class="at">Tmax_interpolated =</span> Tmax_int<span class="sc">$</span>missing)</span></code></pre></div>
<p>The <code>fix_weather()</code> function in <code>chillR</code> uses linear interpolation to fill gaps in minimum and maximum temperature data by default. If any entire days are missing, it adds rows for these dates using <code>make_all_day_table()</code>. Users can also customize the function by setting the range of years (with <code>start_year</code> and <code>end_year</code>), specifying specific dates (using <code>start_date</code> and <code>end_date</code> in Julian days), and choosing column names if they differ from <code>Tmin</code> and <code>Tmax</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="filling-gaps-in-temperature-records.html#cb115-1" tabindex="-1"></a><span class="co"># add an extra day to the KA_weather dataset that is not connected to the days that are already there.</span></span>
<span id="cb115-2"><a href="filling-gaps-in-temperature-records.html#cb115-2" tabindex="-1"></a><span class="co"># this creates a large gap, which we can then interpolate</span></span>
<span id="cb115-3"><a href="filling-gaps-in-temperature-records.html#cb115-3" tabindex="-1"></a>KA_weather_gap <span class="ot">&lt;-</span> <span class="fu">rbind</span>(KA_weather, <span class="fu">c</span>(<span class="at">Year =</span> <span class="dv">2011</span>,</span>
<span id="cb115-4"><a href="filling-gaps-in-temperature-records.html#cb115-4" tabindex="-1"></a>                                      <span class="at">Month =</span> <span class="dv">3</span>,</span>
<span id="cb115-5"><a href="filling-gaps-in-temperature-records.html#cb115-5" tabindex="-1"></a>                                      <span class="at">Day =</span> <span class="dv">3</span>,</span>
<span id="cb115-6"><a href="filling-gaps-in-temperature-records.html#cb115-6" tabindex="-1"></a>                                      <span class="at">Tmax =</span> <span class="dv">26</span>,</span>
<span id="cb115-7"><a href="filling-gaps-in-temperature-records.html#cb115-7" tabindex="-1"></a>                                      <span class="at">Tmin =</span> <span class="dv">14</span>)) </span>
<span id="cb115-8"><a href="filling-gaps-in-temperature-records.html#cb115-8" tabindex="-1"></a></span>
<span id="cb115-9"><a href="filling-gaps-in-temperature-records.html#cb115-9" tabindex="-1"></a><span class="co"># fill in the gaps between Julian date 300 (late October) and 100 (early April), only returning data between 2000 and 2011</span></span>
<span id="cb115-10"><a href="filling-gaps-in-temperature-records.html#cb115-10" tabindex="-1"></a>fixed_winter_days <span class="ot">&lt;-</span> KA_weather_gap <span class="sc">%&gt;%</span> <span class="fu">fix_weather</span>(<span class="at">start_year =</span> <span class="dv">2000</span>,</span>
<span id="cb115-11"><a href="filling-gaps-in-temperature-records.html#cb115-11" tabindex="-1"></a>                                                    <span class="at">end_year =</span> <span class="dv">2011</span>,</span>
<span id="cb115-12"><a href="filling-gaps-in-temperature-records.html#cb115-12" tabindex="-1"></a>                                                    <span class="at">start_date =</span> <span class="dv">300</span>,</span>
<span id="cb115-13"><a href="filling-gaps-in-temperature-records.html#cb115-13" tabindex="-1"></a>                                                    <span class="at">end_date =</span> <span class="dv">100</span>)</span>
<span id="cb115-14"><a href="filling-gaps-in-temperature-records.html#cb115-14" tabindex="-1"></a></span>
<span id="cb115-15"><a href="filling-gaps-in-temperature-records.html#cb115-15" tabindex="-1"></a><span class="co"># fill in all gaps</span></span>
<span id="cb115-16"><a href="filling-gaps-in-temperature-records.html#cb115-16" tabindex="-1"></a>fixed_all_days <span class="ot">&lt;-</span> KA_weather_gap <span class="sc">%&gt;%</span> <span class="fu">fix_weather</span>()</span></code></pre></div>
<p>The <code>fix_weather()</code> function returns a list with two components:</p>
<ol style="list-style-type: decimal">
<li><code>weather</code>: A <code>data.frame</code> containing the interpolated weather data. It includes two additional columns, <code>no_Tmin</code> and <code>no_Tmax</code>, which mark rows where minimum or maximum temperatures were originally missing (indicated as <code>TRUE</code>, otherwise <code>FALSE</code>).</li>
<li><code>QC:</code> A quality control object that summarizes the number of interpolated values for each season.</li>
</ol>
<p>These QC elements provide an overview of the data quality and interpolation extent for each dataset processed:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="filling-gaps-in-temperature-records.html#cb116-1" tabindex="-1"></a>fixed_winter_days<span class="sc">$</span>QC</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
End_year
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Data_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmax
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Incomplete_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Perc_complete
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1999/2000
</td>
<td style="text-align:center;">
2000
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
100
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
60.2
</td>
</tr>
<tr>
<td style="text-align:center;">
2000/2001
</td>
<td style="text-align:center;">
2001
</td>
<td style="text-align:center;">
167
</td>
<td style="text-align:center;">
167
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2001/2002
</td>
<td style="text-align:center;">
2002
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2002/2003
</td>
<td style="text-align:center;">
2003
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2003/2004
</td>
<td style="text-align:center;">
2004
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2004/2005
</td>
<td style="text-align:center;">
2005
</td>
<td style="text-align:center;">
167
</td>
<td style="text-align:center;">
167
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2005/2006
</td>
<td style="text-align:center;">
2006
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2006/2007
</td>
<td style="text-align:center;">
2007
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2008/2009
</td>
<td style="text-align:center;">
2009
</td>
<td style="text-align:center;">
167
</td>
<td style="text-align:center;">
167
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2009/2010
</td>
<td style="text-align:center;">
2010
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2010/2011
</td>
<td style="text-align:center;">
2011
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
128
</td>
<td style="text-align:center;">
165
</td>
<td style="text-align:center;">
165
</td>
<td style="text-align:center;">
165
</td>
<td style="text-align:center;">
0.6
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="filling-gaps-in-temperature-records.html#cb117-1" tabindex="-1"></a>fixed_all_days<span class="sc">$</span>QC</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
End_year
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Data_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmax
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Incomplete_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Perc_complete
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1997/1998
</td>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1998/1999
</td>
<td style="text-align:center;">
1999
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1999/2000
</td>
<td style="text-align:center;">
2000
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2000/2001
</td>
<td style="text-align:center;">
2001
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2001/2002
</td>
<td style="text-align:center;">
2002
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2002/2003
</td>
<td style="text-align:center;">
2003
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2003/2004
</td>
<td style="text-align:center;">
2004
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2004/2005
</td>
<td style="text-align:center;">
2005
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2005/2006
</td>
<td style="text-align:center;">
2006
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2006/2007
</td>
<td style="text-align:center;">
2007
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2008/2009
</td>
<td style="text-align:center;">
2009
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2009/2010
</td>
<td style="text-align:center;">
2010
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
214
</td>
<td style="text-align:center;">
214
</td>
<td style="text-align:center;">
214
</td>
<td style="text-align:center;">
41.4
</td>
</tr>
<tr>
<td style="text-align:center;">
2010/2011
</td>
<td style="text-align:center;">
2011
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
62
</td>
<td style="text-align:center;">
364
</td>
<td style="text-align:center;">
364
</td>
<td style="text-align:center;">
364
</td>
<td style="text-align:center;">
0.3
</td>
</tr>
</tbody>
</table>
</div>
<p>As mentioned, linear interpolation works reasonably well for short gaps in data but becomes less reliable as the gaps lengthen. Below is a simple demonstration of this effect:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="filling-gaps-in-temperature-records.html#cb118-1" tabindex="-1"></a>gap_weather <span class="ot">&lt;-</span> KA_weather[<span class="dv">200</span><span class="sc">:</span><span class="dv">305</span>, ]</span>
<span id="cb118-2"><a href="filling-gaps-in-temperature-records.html#cb118-2" tabindex="-1"></a>gap_weather[ ,<span class="st">&quot;Tmin_observed&quot;</span>] <span class="ot">&lt;-</span> gap_weather<span class="sc">$</span>Tmin</span>
<span id="cb118-3"><a href="filling-gaps-in-temperature-records.html#cb118-3" tabindex="-1"></a>gap_weather<span class="sc">$</span>Tmin[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">22</span><span class="sc">:</span><span class="dv">27</span>, <span class="dv">29</span><span class="sc">:</span><span class="dv">35</span>, </span>
<span id="cb118-4"><a href="filling-gaps-in-temperature-records.html#cb118-4" tabindex="-1"></a>                   <span class="dv">37</span><span class="sc">:</span><span class="dv">44</span>, <span class="dv">46</span><span class="sc">:</span><span class="dv">54</span>, <span class="dv">56</span><span class="sc">:</span><span class="dv">65</span>, <span class="dv">67</span><span class="sc">:</span><span class="dv">77</span>, <span class="dv">79</span><span class="sc">:</span><span class="dv">90</span>, <span class="dv">92</span><span class="sc">:</span><span class="dv">104</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb118-5"><a href="filling-gaps-in-temperature-records.html#cb118-5" tabindex="-1"></a>fixed_gaps <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(gap_weather)<span class="sc">$</span>weather</span>
<span id="cb118-6"><a href="filling-gaps-in-temperature-records.html#cb118-6" tabindex="-1"></a></span>
<span id="cb118-7"><a href="filling-gaps-in-temperature-records.html#cb118-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fixed_gaps,</span>
<span id="cb118-8"><a href="filling-gaps-in-temperature-records.html#cb118-8" tabindex="-1"></a>       <span class="fu">aes</span>(DATE, Tmin_observed)) <span class="sc">+</span></span>
<span id="cb118-9"><a href="filling-gaps-in-temperature-records.html#cb118-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb118-10"><a href="filling-gaps-in-temperature-records.html#cb118-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb118-11"><a href="filling-gaps-in-temperature-records.html#cb118-11" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Daily minimum temperature (Â°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb118-12"><a href="filling-gaps-in-temperature-records.html#cb118-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fixed_gaps, <span class="fu">aes</span>(DATE, Tmin), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>The plot illustrates original temperature measurements (in black) alongside interpolated values (in red). To simulate gaps, values were removed incrementally from the dataset - starting with single missing values on the left and increasing up to 13 consecutive missing values on the right. The results show that for shorter gaps (left side), interpolation closely follows the temperature trends. However, as gaps grow longer (right side), the interpolated values deviate more significantly, failing to capture the actual temperature dynamics accurately. This visual demonstrates the diminishing reliability of linear interpolation as gaps increase in size.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="filling-gaps-in-temperature-records.html#cb119-1" tabindex="-1"></a>fixed_gaps[,<span class="st">&quot;error&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">abs</span>(fixed_gaps<span class="sc">$</span>Tmin <span class="sc">-</span> fixed_gaps<span class="sc">$</span>Tmin_observed)</span>
<span id="cb119-2"><a href="filling-gaps-in-temperature-records.html#cb119-2" tabindex="-1"></a></span>
<span id="cb119-3"><a href="filling-gaps-in-temperature-records.html#cb119-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fixed_gaps,</span>
<span id="cb119-4"><a href="filling-gaps-in-temperature-records.html#cb119-4" tabindex="-1"></a>       <span class="fu">aes</span>(DATE, error)) <span class="sc">+</span></span>
<span id="cb119-5"><a href="filling-gaps-in-temperature-records.html#cb119-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb119-6"><a href="filling-gaps-in-temperature-records.html#cb119-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-7"><a href="filling-gaps-in-temperature-records.html#cb119-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Error introduced by interpolation (Â°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-8"><a href="filling-gaps-in-temperature-records.html#cb119-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> fixed_gaps[<span class="fu">which</span>(<span class="sc">!</span>fixed_gaps<span class="sc">$</span>no_Tmin),],</span>
<span id="cb119-9"><a href="filling-gaps-in-temperature-records.html#cb119-9" tabindex="-1"></a>             <span class="fu">aes</span>(DATE, error),<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>The size of interpolation errors depends on temperature variation during the missing periods - high variation leads to larger errors. As gap sizes increase, errors tend to grow, especially in the middle of large gaps, where interpolated values can be far from actual conditions. While errors are zero at points where data exists, larger gaps clearly require a more advanced method for accurate estimation.</p>
</div>
<div id="filling-long-gaps-in-daily-records" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Filling long gaps in daily records<a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Long gaps in temperature records are a persistent issue because actual temperatures at specific times and locations are unknown if no measurements were taken. While linear interpolation can provide reasonable estimates for short gaps, longer gaps require more reliable approaches. Instead of using complex interpolation algorithms, an effective solution can be to incorporate additional data from nearby weather stations in climatically similar settings.</p>
<p>Typically, if another station close to the target site has a similar climate, its data can be used to fill in gaps. For example, this method is used in the <a href="https://cimis.water.ca.gov/">CIMIS</a> network in California, where data from nearby stations is often used to address missing values. However, this approach has limitations, as even small differences in elevation or unique landscape features (like lakes, forests, or coastlines) can lead to climate variations that make nearby stations less accurate proxies.</p>
<p>In <code>chillR</code>, the <code>patch_weather()</code> function addresses these limitations by using data from auxiliary stations to fill gaps. It can detect certain biases, adjust for mean temperature biases, and apply the corrected data to the location of interest, thus providing a more refined way to handle missing temperature records.</p>
<p>To fill gaps in the temperature dataset for Bonn, downloaded in the <em>Getting temperature data</em> lesson, the following steps should be taken:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="filling-gaps-in-temperature-records.html#cb120-1" tabindex="-1"></a>Bonn <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Bonn_chillR_weather.csv&quot;</span>)</span>
<span id="cb120-2"><a href="filling-gaps-in-temperature-records.html#cb120-2" tabindex="-1"></a>Bonn_QC <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(Bonn)<span class="sc">$</span>QC</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="filling-gaps-in-temperature-records.html#cb121-1" tabindex="-1"></a>Bonn_QC</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
End_year
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Data_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmax
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Incomplete_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Perc_complete
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1989/1990
</td>
<td style="text-align:center;">
1990
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1990/1991
</td>
<td style="text-align:center;">
1991
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1991/1992
</td>
<td style="text-align:center;">
1992
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1992/1993
</td>
<td style="text-align:center;">
1993
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1993/1994
</td>
<td style="text-align:center;">
1994
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1994/1995
</td>
<td style="text-align:center;">
1995
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1995/1996
</td>
<td style="text-align:center;">
1996
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1996/1997
</td>
<td style="text-align:center;">
1997
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1997/1998
</td>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
98.9
</td>
</tr>
<tr>
<td style="text-align:center;">
1998/1999
</td>
<td style="text-align:center;">
1999
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1999/2000
</td>
<td style="text-align:center;">
2000
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2000/2001
</td>
<td style="text-align:center;">
2001
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2001/2002
</td>
<td style="text-align:center;">
2002
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2002/2003
</td>
<td style="text-align:center;">
2003
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
316
</td>
<td style="text-align:center;">
316
</td>
<td style="text-align:center;">
316
</td>
<td style="text-align:center;">
13.4
</td>
</tr>
<tr>
<td style="text-align:center;">
2003/2004
</td>
<td style="text-align:center;">
2004
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2004/2005
</td>
<td style="text-align:center;">
2005
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2005/2006
</td>
<td style="text-align:center;">
2006
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2006/2007
</td>
<td style="text-align:center;">
2007
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2008/2009
</td>
<td style="text-align:center;">
2009
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2009/2010
</td>
<td style="text-align:center;">
2010
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2010/2011
</td>
<td style="text-align:center;">
2011
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2011/2012
</td>
<td style="text-align:center;">
2012
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2012/2013
</td>
<td style="text-align:center;">
2013
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2013/2014
</td>
<td style="text-align:center;">
2014
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2014/2015
</td>
<td style="text-align:center;">
2015
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2015/2016
</td>
<td style="text-align:center;">
2016
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2016/2017
</td>
<td style="text-align:center;">
2017
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2017/2018
</td>
<td style="text-align:center;">
2018
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2018/2019
</td>
<td style="text-align:center;">
2019
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2019/2020
</td>
<td style="text-align:center;">
2020
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
</tbody>
</table>
</div>
<p>The dataset for Bonn has significant gaps between 1998 and 2004, as well as in 2008 (where almost all values are missing), along with shorter gaps in 2015, 2018, and 2020.</p>
<p>To address these gaps, data from nearby weather stations is required. The <code>handle_gsod()</code> function can be used to find relevant stations in the surrounding area.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="filling-gaps-in-temperature-records.html#cb122-1" tabindex="-1"></a>station_list <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;list_stations&quot;</span>,</span>
<span id="cb122-2"><a href="filling-gaps-in-temperature-records.html#cb122-2" tabindex="-1"></a>                            <span class="at">location =</span> <span class="fu">c</span>(<span class="fl">7.10</span>, <span class="fl">50.73</span>),</span>
<span id="cb122-3"><a href="filling-gaps-in-temperature-records.html#cb122-3" tabindex="-1"></a>                            <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">2020</span>))</span></code></pre></div>
<pre><code>##    chillR_code        STATION.NAME CTRY    Lat  Long    BEGIN      END Distance Overlap_years
## 1  10517099999 BONN/FRIESDORF(AUT)   GM 50.700 7.150 19360102 19921231     4.86          3.00
## 2  10518099999     BONN-HARDTHOEHE   GM 50.700 7.033 19750523 19971223     5.79          7.98
## 3  10519099999        BONN-ROLEBER   GM 50.733 7.200 20010705 20081231     7.07          7.49
## 4  10513099999           KOLN BONN   GM 50.866 7.143 19310101 20230729    15.43         31.00
## 5  10509099999 BUTZWEILERHOF(BAFB)   GM 50.983 6.900 19780901 19950823    31.47          5.64
## 6  10502099999           NORVENICH   GM 50.831 6.658 19730101 20230729    33.14         31.00
## 7  10514099999              MENDIG   GM 50.366 7.315 19730102 19971231    43.26          8.00
## 8  10506099999  NUERBURG-BARWEILER   GM 50.367 6.867 19950401 19971231    43.63          2.75
## 9  10508099999         BLANKENHEIM   GM 50.450 6.650 19781002 19840504    44.56          0.00
## 10 10510099999            NUERBURG   GM 50.333 6.950 19300901 19921231    45.42          3.00
## 11 10515099999             BENDORF   GM 50.417 7.583 19310102 20030816    48.82         13.62
## 12 10504099999               EIFEL   GM 50.650 6.283 20040501 20040501    58.41          0.00
## 13 10526099999      BAD MARIENBERG   GM 50.667 7.967 19730101 20030816    61.65         13.62
## 14 10613099999              BUCHEL   GM 50.174 7.063 19730101 20230729    61.90         31.00
## 15 10503099999    AACHEN/MERZBRUCK   GM 50.817 6.183 19780901 19971212    65.40          7.95
## 16 10419099999 LUDENSCHEID       &amp;   GM 51.233 7.600 19270906 20030306    66.06         13.18
## 17 10400099999          DUSSELDORF   GM 51.289 6.767 19310102 20230729    66.43         31.00
## 18 10616299999          SIEGERLAND   GM 50.708 8.083 20040510 20230729    69.46         16.65
## 19 10418099999        LUEDENSCHEID   GM 51.250 7.650 19940301 19971231    69.55          3.84
## 20 10437499999     MONCHENGLADBACH   GM 51.230 6.504 19960715 20230729    69.61         24.47
## 21 10403099999    MOENCHENGLADBACH   GM 51.233 6.500 19381001 19421031    70.05          0.00
## 22 10501099999              AACHEN   GM 50.783 6.100 19280101 20030816    70.81         13.62
## 23  6496099999     ELSENBORN (MIL)   BE 50.467 6.183 19840501 20230729    71.21         31.00
## 24 10409099999      ESSEN/MUELHEIM   GM 51.400 6.967 19300414 19431231    75.12          0.00
## 25 10410099999       ESSEN/MULHEIM   GM 51.400 6.967 19310101 20220408    75.12         31.00
##    Perc_interval_covered
## 1                     10
## 2                     26
## 3                     24
## 4                    100
## 5                     18
## 6                    100
## 7                     26
## 8                      9
## 9                      0
## 10                    10
## 11                    44
## 12                     0
## 13                    44
## 14                   100
## 15                    26
## 16                    43
## 17                   100
## 18                    54
## 19                    12
## 20                    79
## 21                     0
## 22                    44
## 23                   100
## 24                     0
## 25                   100</code></pre>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
chillR_code
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
STATION.NAME
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
CTRY
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Lat
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Long
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
BEGIN
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
END
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Distance
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Overlap_years
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Perc_interval_covered
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
10517099999
</td>
<td style="text-align:center;">
BONN/FRIESDORF(AUT)
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.700
</td>
<td style="text-align:center;">
7.150
</td>
<td style="text-align:center;">
19360102
</td>
<td style="text-align:center;">
19921231
</td>
<td style="text-align:center;">
4.86
</td>
<td style="text-align:center;">
3.00
</td>
<td style="text-align:center;">
10
</td>
</tr>
<tr>
<td style="text-align:center;">
10518099999
</td>
<td style="text-align:center;">
BONN-HARDTHOEHE
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.700
</td>
<td style="text-align:center;">
7.033
</td>
<td style="text-align:center;">
19750523
</td>
<td style="text-align:center;">
19971223
</td>
<td style="text-align:center;">
5.79
</td>
<td style="text-align:center;">
7.98
</td>
<td style="text-align:center;">
26
</td>
</tr>
<tr>
<td style="text-align:center;">
10519099999
</td>
<td style="text-align:center;">
BONN-ROLEBER
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.733
</td>
<td style="text-align:center;">
7.200
</td>
<td style="text-align:center;">
20010705
</td>
<td style="text-align:center;">
20081231
</td>
<td style="text-align:center;">
7.07
</td>
<td style="text-align:center;">
7.49
</td>
<td style="text-align:center;">
24
</td>
</tr>
<tr>
<td style="text-align:center;">
10513099999
</td>
<td style="text-align:center;">
KOLN BONN
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.866
</td>
<td style="text-align:center;">
7.143
</td>
<td style="text-align:center;">
19310101
</td>
<td style="text-align:center;">
20230729
</td>
<td style="text-align:center;">
15.43
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
10509099999
</td>
<td style="text-align:center;">
BUTZWEILERHOF(BAFB)
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.983
</td>
<td style="text-align:center;">
6.900
</td>
<td style="text-align:center;">
19780901
</td>
<td style="text-align:center;">
19950823
</td>
<td style="text-align:center;">
31.47
</td>
<td style="text-align:center;">
5.64
</td>
<td style="text-align:center;">
18
</td>
</tr>
<tr>
<td style="text-align:center;">
10502099999
</td>
<td style="text-align:center;">
NORVENICH
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.831
</td>
<td style="text-align:center;">
6.658
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
20230729
</td>
<td style="text-align:center;">
33.14
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
10514099999
</td>
<td style="text-align:center;">
MENDIG
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.366
</td>
<td style="text-align:center;">
7.315
</td>
<td style="text-align:center;">
19730102
</td>
<td style="text-align:center;">
19971231
</td>
<td style="text-align:center;">
43.26
</td>
<td style="text-align:center;">
8.00
</td>
<td style="text-align:center;">
26
</td>
</tr>
<tr>
<td style="text-align:center;">
10506099999
</td>
<td style="text-align:center;">
NUERBURG-BARWEILER
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.367
</td>
<td style="text-align:center;">
6.867
</td>
<td style="text-align:center;">
19950401
</td>
<td style="text-align:center;">
19971231
</td>
<td style="text-align:center;">
43.63
</td>
<td style="text-align:center;">
2.75
</td>
<td style="text-align:center;">
9
</td>
</tr>
<tr>
<td style="text-align:center;">
10508099999
</td>
<td style="text-align:center;">
BLANKENHEIM
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.450
</td>
<td style="text-align:center;">
6.650
</td>
<td style="text-align:center;">
19781002
</td>
<td style="text-align:center;">
19840504
</td>
<td style="text-align:center;">
44.56
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
10510099999
</td>
<td style="text-align:center;">
NUERBURG
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.333
</td>
<td style="text-align:center;">
6.950
</td>
<td style="text-align:center;">
19300901
</td>
<td style="text-align:center;">
19921231
</td>
<td style="text-align:center;">
45.42
</td>
<td style="text-align:center;">
3.00
</td>
<td style="text-align:center;">
10
</td>
</tr>
<tr>
<td style="text-align:center;">
10515099999
</td>
<td style="text-align:center;">
BENDORF
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.417
</td>
<td style="text-align:center;">
7.583
</td>
<td style="text-align:center;">
19310102
</td>
<td style="text-align:center;">
20030816
</td>
<td style="text-align:center;">
48.82
</td>
<td style="text-align:center;">
13.62
</td>
<td style="text-align:center;">
44
</td>
</tr>
<tr>
<td style="text-align:center;">
10504099999
</td>
<td style="text-align:center;">
EIFEL
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.650
</td>
<td style="text-align:center;">
6.283
</td>
<td style="text-align:center;">
20040501
</td>
<td style="text-align:center;">
20040501
</td>
<td style="text-align:center;">
58.41
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
10526099999
</td>
<td style="text-align:center;">
BAD MARIENBERG
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.667
</td>
<td style="text-align:center;">
7.967
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
20030816
</td>
<td style="text-align:center;">
61.65
</td>
<td style="text-align:center;">
13.62
</td>
<td style="text-align:center;">
44
</td>
</tr>
<tr>
<td style="text-align:center;">
10613099999
</td>
<td style="text-align:center;">
BUCHEL
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.174
</td>
<td style="text-align:center;">
7.063
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
20230729
</td>
<td style="text-align:center;">
61.90
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
10503099999
</td>
<td style="text-align:center;">
AACHEN/MERZBRUCK
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.817
</td>
<td style="text-align:center;">
6.183
</td>
<td style="text-align:center;">
19780901
</td>
<td style="text-align:center;">
19971212
</td>
<td style="text-align:center;">
65.40
</td>
<td style="text-align:center;">
7.95
</td>
<td style="text-align:center;">
26
</td>
</tr>
<tr>
<td style="text-align:center;">
10419099999
</td>
<td style="text-align:center;">
LUDENSCHEID &amp;
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
51.233
</td>
<td style="text-align:center;">
7.600
</td>
<td style="text-align:center;">
19270906
</td>
<td style="text-align:center;">
20030306
</td>
<td style="text-align:center;">
66.06
</td>
<td style="text-align:center;">
13.18
</td>
<td style="text-align:center;">
43
</td>
</tr>
<tr>
<td style="text-align:center;">
10400099999
</td>
<td style="text-align:center;">
DUSSELDORF
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
51.289
</td>
<td style="text-align:center;">
6.767
</td>
<td style="text-align:center;">
19310102
</td>
<td style="text-align:center;">
20230729
</td>
<td style="text-align:center;">
66.43
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
10616299999
</td>
<td style="text-align:center;">
SIEGERLAND
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.708
</td>
<td style="text-align:center;">
8.083
</td>
<td style="text-align:center;">
20040510
</td>
<td style="text-align:center;">
20230729
</td>
<td style="text-align:center;">
69.46
</td>
<td style="text-align:center;">
16.65
</td>
<td style="text-align:center;">
54
</td>
</tr>
<tr>
<td style="text-align:center;">
10418099999
</td>
<td style="text-align:center;">
LUEDENSCHEID
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
51.250
</td>
<td style="text-align:center;">
7.650
</td>
<td style="text-align:center;">
19940301
</td>
<td style="text-align:center;">
19971231
</td>
<td style="text-align:center;">
69.55
</td>
<td style="text-align:center;">
3.84
</td>
<td style="text-align:center;">
12
</td>
</tr>
<tr>
<td style="text-align:center;">
10437499999
</td>
<td style="text-align:center;">
MONCHENGLADBACH
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
51.230
</td>
<td style="text-align:center;">
6.504
</td>
<td style="text-align:center;">
19960715
</td>
<td style="text-align:center;">
20230729
</td>
<td style="text-align:center;">
69.61
</td>
<td style="text-align:center;">
24.47
</td>
<td style="text-align:center;">
79
</td>
</tr>
<tr>
<td style="text-align:center;">
10403099999
</td>
<td style="text-align:center;">
MOENCHENGLADBACH
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
51.233
</td>
<td style="text-align:center;">
6.500
</td>
<td style="text-align:center;">
19381001
</td>
<td style="text-align:center;">
19421031
</td>
<td style="text-align:center;">
70.05
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
10501099999
</td>
<td style="text-align:center;">
AACHEN
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
50.783
</td>
<td style="text-align:center;">
6.100
</td>
<td style="text-align:center;">
19280101
</td>
<td style="text-align:center;">
20030816
</td>
<td style="text-align:center;">
70.81
</td>
<td style="text-align:center;">
13.62
</td>
<td style="text-align:center;">
44
</td>
</tr>
<tr>
<td style="text-align:center;">
6496099999
</td>
<td style="text-align:center;">
ELSENBORN (MIL)
</td>
<td style="text-align:center;">
BE
</td>
<td style="text-align:center;">
50.467
</td>
<td style="text-align:center;">
6.183
</td>
<td style="text-align:center;">
19840501
</td>
<td style="text-align:center;">
20230729
</td>
<td style="text-align:center;">
71.21
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
10409099999
</td>
<td style="text-align:center;">
ESSEN/MUELHEIM
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
51.400
</td>
<td style="text-align:center;">
6.967
</td>
<td style="text-align:center;">
19300414
</td>
<td style="text-align:center;">
19431231
</td>
<td style="text-align:center;">
75.12
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
10410099999
</td>
<td style="text-align:center;">
ESSEN/MULHEIM
</td>
<td style="text-align:center;">
GM
</td>
<td style="text-align:center;">
51.400
</td>
<td style="text-align:center;">
6.967
</td>
<td style="text-align:center;">
19310101
</td>
<td style="text-align:center;">
20220408
</td>
<td style="text-align:center;">
75.12
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
</tbody>
</table>
</div>
<p>Many of the stations listed may not be useful, as they only overlap with the existing record for a few years, or not at all. As a result, itâ€™s unlikely that any single station will be able to fill all the gaps in Bonnâ€™s temperature data. However, by combining data from multiple auxiliary stations, it may be possible to fill in the missing values. Promising stations include <strong>BONN-HARDTHOEHE</strong>, <strong>BONN-ROLEBER</strong>, and <strong>NORVENICH</strong>. These stations will be downloaded and stored in a list.</p>
<p>In <code>chillR</code> version 0.74 and later, the <code>handle_gsod()</code> function can download multiple station records at once, returning them as a named list. This function will be used to download the records for the selected stations (positions 2, 3, and 6 in the station list).</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="filling-gaps-in-temperature-records.html#cb124-1" tabindex="-1"></a>patch_weather <span class="ot">&lt;-</span></span>
<span id="cb124-2"><a href="filling-gaps-in-temperature-records.html#cb124-2" tabindex="-1"></a>      <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;download_weather&quot;</span>,</span>
<span id="cb124-3"><a href="filling-gaps-in-temperature-records.html#cb124-3" tabindex="-1"></a>                  <span class="at">location =</span> <span class="fu">as.character</span>(station_list<span class="sc">$</span>chillR_code[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)]),</span>
<span id="cb124-4"><a href="filling-gaps-in-temperature-records.html#cb124-4" tabindex="-1"></a>                  <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">2020</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb124-5"><a href="filling-gaps-in-temperature-records.html#cb124-5" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span></code></pre></div>
<pre><code>## Loading data for 31 years from station &#39;NORVENICH&#39;
## ==============================================================================================
## 
## Loading data for 31 years from station &#39;BONN-HARDTHOEHE&#39;
## ==============================================================================================
## 
## Loading data for 31 years from station &#39;BONN-ROLEBER&#39;
## ==============================================================================================</code></pre>
<p>With the list of potentially useful weather records now available, the next step is to use the <code>patch_daily_temperatures()</code> function. This function will integrate the data from the selected auxiliary stations to fill the missing temperature values in the Bonn dataset:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="filling-gaps-in-temperature-records.html#cb126-1" tabindex="-1"></a>patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(<span class="at">weather =</span> Bonn,</span>
<span id="cb126-2"><a href="filling-gaps-in-temperature-records.html#cb126-2" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather)</span></code></pre></div>
<p>The results can be reviewed by examining the statistics element of the patched object, accessed using <code>patched$statistics</code>. This will provide an overview of how the gaps were filled and the adjustments made using the auxiliary station data.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="filling-gaps-in-temperature-records.html#cb127-1" tabindex="-1"></a><span class="co"># Patch statistics for NORVENICH</span></span>
<span id="cb127-2"><a href="filling-gaps-in-temperature-records.html#cb127-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">1</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mean_bias
</th>
<th style="text-align:center;">
stdev_bias
</th>
<th style="text-align:center;">
filled
</th>
<th style="text-align:center;">
gaps_remain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tmin
</td>
<td style="text-align:center;">
-0.307
</td>
<td style="text-align:center;">
1.304
</td>
<td style="text-align:center;">
2146
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Tmax
</td>
<td style="text-align:center;">
0.202
</td>
<td style="text-align:center;">
1.154
</td>
<td style="text-align:center;">
2146
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="filling-gaps-in-temperature-records.html#cb128-1" tabindex="-1"></a><span class="co"># Patch statistics for BONN-HARDTHOEHE</span></span>
<span id="cb128-2"><a href="filling-gaps-in-temperature-records.html#cb128-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">2</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mean_bias
</th>
<th style="text-align:center;">
stdev_bias
</th>
<th style="text-align:center;">
filled
</th>
<th style="text-align:center;">
gaps_remain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tmin
</td>
<td style="text-align:center;">
-1.871
</td>
<td style="text-align:center;">
2.080
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Tmax
</td>
<td style="text-align:center;">
1.466
</td>
<td style="text-align:center;">
1.427
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="filling-gaps-in-temperature-records.html#cb129-1" tabindex="-1"></a><span class="co"># Patch statistics for BONN-ROLEBER</span></span>
<span id="cb129-2"><a href="filling-gaps-in-temperature-records.html#cb129-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">3</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mean_bias
</th>
<th style="text-align:center;">
stdev_bias
</th>
<th style="text-align:center;">
filled
</th>
<th style="text-align:center;">
gaps_remain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tmin
</td>
<td style="text-align:center;">
-0.546
</td>
<td style="text-align:center;">
1.186
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Tmax
</td>
<td style="text-align:center;">
1.314
</td>
<td style="text-align:center;">
1.089
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<p>The analysis provides insight into the similarity between the temperature records from the auxiliary stations and the target station in Bonn, specifically for both <code>Tmin</code> and <code>Tmax</code>. It includes the following statistics:</p>
<ol style="list-style-type: decimal">
<li><code>filled</code>: The number of days for which data was successfully transferred from each auxiliary station.</li>
<li><code>gaps_remain</code>: The number of gaps still present after the patching process.</li>
</ol>
<p>Additionally, two quality statistics are provided:</p>
<ul>
<li><p><strong>Mean Bias (</strong><code>mean_bias</code><strong>)</strong>: The average temperature difference between the auxiliary station and the Bonn station. This can be easily addressed by adjusting daily temperature values when transferring data between stations, and the <code>patch_daily_temperatures()</code> function automatically corrects for this.</p></li>
<li><p><strong>Standard Deviation of Daily Differences (</strong><code>stdev_bias</code><strong>)</strong>: This indicates the variability in the differences between the stations. A high stdev_bias suggests that the temperature differences are not systematic and may not be easily corrected. If the stdev_bias exceeds a certain threshold, it may be best to exclude that station from the data transfer.</p></li>
</ul>
<p>To address these metrics, limits can be set for both. The <code>mean_bias</code> can be capped at 1Â°C, and the <code>stdev_bias</code> can be capped at 2Â°C. These thresholds will be passed as parameters (<code>max_mean_bias</code> and <code>max_stdev_bias</code>) to the <code>patch_daily_temperatures()</code> function. After setting these limits, the statistics should be reviewed again to ensure the quality of the patching process.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="filling-gaps-in-temperature-records.html#cb130-1" tabindex="-1"></a>patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(<span class="at">weather =</span> Bonn,</span>
<span id="cb130-2"><a href="filling-gaps-in-temperature-records.html#cb130-2" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb130-3"><a href="filling-gaps-in-temperature-records.html#cb130-3" tabindex="-1"></a>                                    <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb130-4"><a href="filling-gaps-in-temperature-records.html#cb130-4" tabindex="-1"></a>                                    <span class="at">max_stdev_bias =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="filling-gaps-in-temperature-records.html#cb131-1" tabindex="-1"></a><span class="co"># Patch statistics for NORVENICH</span></span>
<span id="cb131-2"><a href="filling-gaps-in-temperature-records.html#cb131-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">1</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mean_bias
</th>
<th style="text-align:center;">
stdev_bias
</th>
<th style="text-align:center;">
filled
</th>
<th style="text-align:center;">
gaps_remain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tmin
</td>
<td style="text-align:center;">
-0.307
</td>
<td style="text-align:center;">
1.304
</td>
<td style="text-align:center;">
2146
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Tmax
</td>
<td style="text-align:center;">
0.202
</td>
<td style="text-align:center;">
1.154
</td>
<td style="text-align:center;">
2146
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="filling-gaps-in-temperature-records.html#cb132-1" tabindex="-1"></a><span class="co"># Patch statistics for BONN-HARDTHOEHE</span></span>
<span id="cb132-2"><a href="filling-gaps-in-temperature-records.html#cb132-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">2</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mean_bias
</th>
<th style="text-align:center;">
stdev_bias
</th>
<th style="text-align:center;">
filled
</th>
<th style="text-align:center;">
gaps_remain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tmin
</td>
<td style="text-align:center;">
-1.871
</td>
<td style="text-align:center;">
2.080
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Tmax
</td>
<td style="text-align:center;">
1.466
</td>
<td style="text-align:center;">
1.427
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="filling-gaps-in-temperature-records.html#cb133-1" tabindex="-1"></a><span class="co"># Patch statistics for BONN-ROLEBER</span></span>
<span id="cb133-2"><a href="filling-gaps-in-temperature-records.html#cb133-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">3</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mean_bias
</th>
<th style="text-align:center;">
stdev_bias
</th>
<th style="text-align:center;">
filled
</th>
<th style="text-align:center;">
gaps_remain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tmin
</td>
<td style="text-align:center;">
-0.546
</td>
<td style="text-align:center;">
1.186
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Tmax
</td>
<td style="text-align:center;">
1.314
</td>
<td style="text-align:center;">
1.089
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<p>After applying the filters, all records from <strong>BONN-HARDTHOEHE</strong> and the <code>Tmax</code> records from <strong>BONN-ROLEBER</strong> were rejected because they did not meet the mean_bias threshold. However, the data from <strong>NORVENICH</strong> were deemed suitable, allowing us to fill 2,146 gaps for both <code>Tmin</code> and <code>Tmax</code>, leaving just 1 gap remaining for each.</p>
<p>To identify where the remaining gaps are, the next step is to use the <code>fix_weather()</code> function. This will allow us to examine the dataset and pinpoint the exact locations of the remaining gaps in both <code>Tmin</code> and <code>Tmax</code>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="filling-gaps-in-temperature-records.html#cb134-1" tabindex="-1"></a>post_patch_stats <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(patched)<span class="sc">$</span>QC</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="filling-gaps-in-temperature-records.html#cb135-1" tabindex="-1"></a>post_patch_stats</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
End_year
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Data_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmax
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Incomplete_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Perc_complete
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1989/1990
</td>
<td style="text-align:center;">
1990
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1990/1991
</td>
<td style="text-align:center;">
1991
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1991/1992
</td>
<td style="text-align:center;">
1992
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1992/1993
</td>
<td style="text-align:center;">
1993
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1993/1994
</td>
<td style="text-align:center;">
1994
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1994/1995
</td>
<td style="text-align:center;">
1995
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1995/1996
</td>
<td style="text-align:center;">
1996
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1996/1997
</td>
<td style="text-align:center;">
1997
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1997/1998
</td>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1998/1999
</td>
<td style="text-align:center;">
1999
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
99.7
</td>
</tr>
<tr>
<td style="text-align:center;">
1999/2000
</td>
<td style="text-align:center;">
2000
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2000/2001
</td>
<td style="text-align:center;">
2001
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2001/2002
</td>
<td style="text-align:center;">
2002
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2002/2003
</td>
<td style="text-align:center;">
2003
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2003/2004
</td>
<td style="text-align:center;">
2004
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2004/2005
</td>
<td style="text-align:center;">
2005
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2005/2006
</td>
<td style="text-align:center;">
2006
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2006/2007
</td>
<td style="text-align:center;">
2007
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2008/2009
</td>
<td style="text-align:center;">
2009
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2009/2010
</td>
<td style="text-align:center;">
2010
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2010/2011
</td>
<td style="text-align:center;">
2011
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2011/2012
</td>
<td style="text-align:center;">
2012
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2012/2013
</td>
<td style="text-align:center;">
2013
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2013/2014
</td>
<td style="text-align:center;">
2014
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2014/2015
</td>
<td style="text-align:center;">
2015
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2015/2016
</td>
<td style="text-align:center;">
2016
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2016/2017
</td>
<td style="text-align:center;">
2017
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2017/2018
</td>
<td style="text-align:center;">
2018
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2018/2019
</td>
<td style="text-align:center;">
2019
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2019/2020
</td>
<td style="text-align:center;">
2020
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100.0
</td>
</tr>
</tbody>
</table>
</div>
<p>After patching the dataset, only a single dayâ€™s data remains missing, which is a very short gap. Given its small size, it is reasonable to use linear interpolation to fill this remaining gap. The <code>fix_weather()</code> function can be used to interpolate this final missing value and complete the dataset.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="filling-gaps-in-temperature-records.html#cb136-1" tabindex="-1"></a>Bonn_weather <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(patched)</span></code></pre></div>
<div id="bias-correction-for-shorter-intervals" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Bias-correction for shorter intervals<a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the <code>patch_daily_temperatures()</code> function, the bias correction is typically based on the average temperature difference between two weather stations over the entire year. However, this approach assumes that the bias between stations is constant throughout the year, which may not be true. In reality, the bias can vary across different seasons, meaning a station might be a good proxy for temperature data during certain times of the year but not others.</p>
<p>To address this, the <code>patch_daily_temps()</code> function (note the slight name difference) allows for seasonally adjusted bias correction. By default, this function evaluates temperature data on a monthly basis, making separate comparisons for each calendar month. It can then assess whether an auxiliary station is a reliable proxy for temperatures in each specific month and apply month-specific bias corrections, leading to more accurate estimations with smaller biases than if the entire year were used for comparison.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="filling-gaps-in-temperature-records.html#cb137-1" tabindex="-1"></a>patched_monthly <span class="ot">&lt;-</span> <span class="fu">patch_daily_temps</span>(<span class="at">weather =</span> Bonn,</span>
<span id="cb137-2"><a href="filling-gaps-in-temperature-records.html#cb137-2" tabindex="-1"></a>                                     <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb137-3"><a href="filling-gaps-in-temperature-records.html#cb137-3" tabindex="-1"></a>                                     <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb137-4"><a href="filling-gaps-in-temperature-records.html#cb137-4" tabindex="-1"></a>                                     <span class="at">max_stdev_bias =</span> <span class="dv">2</span>,</span>
<span id="cb137-5"><a href="filling-gaps-in-temperature-records.html#cb137-5" tabindex="-1"></a>                                     <span class="at">time_interval =</span> <span class="st">&quot;month&quot;</span>)</span></code></pre></div>
<p>The findings for minimum temperatures from the <strong>NORVENICH</strong> station can be summarized as follows:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="filling-gaps-in-temperature-records.html#cb138-1" tabindex="-1"></a>patched_monthly<span class="sc">$</span>statistics<span class="sc">$</span>Tmin<span class="sc">$</span>NORVENICH</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Interval
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Total_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Overlap_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Mean_bias
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Stdev_bias
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Gaps_before
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Filled
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Gaps_remain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
961
</td>
<td style="text-align:center;">
773
</td>
<td style="text-align:center;">
0.184
</td>
<td style="text-align:center;">
1.260
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
185
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
961
</td>
<td style="text-align:center;">
774
</td>
<td style="text-align:center;">
0.281
</td>
<td style="text-align:center;">
1.242
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
876
</td>
<td style="text-align:center;">
706
</td>
<td style="text-align:center;">
0.269
</td>
<td style="text-align:center;">
1.248
</td>
<td style="text-align:center;">
170
</td>
<td style="text-align:center;">
170
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
961
</td>
<td style="text-align:center;">
775
</td>
<td style="text-align:center;">
0.253
</td>
<td style="text-align:center;">
1.427
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
930
</td>
<td style="text-align:center;">
758
</td>
<td style="text-align:center;">
0.509
</td>
<td style="text-align:center;">
1.431
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
166
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
961
</td>
<td style="text-align:center;">
801
</td>
<td style="text-align:center;">
0.373
</td>
<td style="text-align:center;">
1.238
</td>
<td style="text-align:center;">
158
</td>
<td style="text-align:center;">
158
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
930
</td>
<td style="text-align:center;">
749
</td>
<td style="text-align:center;">
0.396
</td>
<td style="text-align:center;">
1.210
</td>
<td style="text-align:center;">
180
</td>
<td style="text-align:center;">
180
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
961
</td>
<td style="text-align:center;">
781
</td>
<td style="text-align:center;">
0.480
</td>
<td style="text-align:center;">
1.305
</td>
<td style="text-align:center;">
179
</td>
<td style="text-align:center;">
179
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
961
</td>
<td style="text-align:center;">
774
</td>
<td style="text-align:center;">
0.529
</td>
<td style="text-align:center;">
1.302
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
930
</td>
<td style="text-align:center;">
750
</td>
<td style="text-align:center;">
0.205
</td>
<td style="text-align:center;">
1.264
</td>
<td style="text-align:center;">
180
</td>
<td style="text-align:center;">
180
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
961
</td>
<td style="text-align:center;">
775
</td>
<td style="text-align:center;">
0.098
</td>
<td style="text-align:center;">
1.307
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
186
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
930
</td>
<td style="text-align:center;">
745
</td>
<td style="text-align:center;">
0.101
</td>
<td style="text-align:center;">
1.308
</td>
<td style="text-align:center;">
184
</td>
<td style="text-align:center;">
184
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
</div>
<p>The analysis shows that the <strong>mean bias</strong> between the stations varies significantly throughout the year, indicating that a month-specific bias correction would likely improve the accuracy of the temperature data.</p>
<p>To implement this, the <code>time_interval</code> parameter in the <code>patch_daily_temps()</code> function allows for flexibility in the interval used for bias correction. Intervals can be set to <code>month</code>, <code>week</code>, or even custom durations like <code>10 days</code> or <code>2 weeks</code>. The function will start counting these intervals from January 1st of each year, which might result in shorter intervals toward the end of the year. This can generate warnings if the final interval is smaller than the selected period.</p>
<p>However, itâ€™s important to keep in mind that using smaller intervals reduces the amount of data available for bias determination. For short time series, very short intervals may not provide enough data, which could reduce the reliability of the bias correction. Therefore, selecting an appropriate interval size is crucial to balancing accuracy and data availability.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="filling-gaps-in-temperature-records.html#cb139-1" tabindex="-1"></a>patched_2weeks <span class="ot">&lt;-</span> <span class="fu">patch_daily_temps</span>(<span class="at">weather =</span> Bonn,</span>
<span id="cb139-2"><a href="filling-gaps-in-temperature-records.html#cb139-2" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb139-3"><a href="filling-gaps-in-temperature-records.html#cb139-3" tabindex="-1"></a>                                    <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb139-4"><a href="filling-gaps-in-temperature-records.html#cb139-4" tabindex="-1"></a>                                    <span class="at">max_stdev_bias =</span> <span class="dv">2</span>,</span>
<span id="cb139-5"><a href="filling-gaps-in-temperature-records.html#cb139-5" tabindex="-1"></a>                                    <span class="at">time_interval =</span> <span class="st">&quot;2 weeks&quot;</span>)</span></code></pre></div>
<p>To demonstrate the effects, 5000 gaps will be created in the Bonn weather record and filled with proxy data using annual, monthly, and bi-weekly intervals for bias evaluation. The resulting errors will be visualized with a violin plot using <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="filling-gaps-in-temperature-records.html#cb140-1" tabindex="-1"></a>Gaps <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Bonn)), <span class="at">size =</span> <span class="dv">5000</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb140-2"><a href="filling-gaps-in-temperature-records.html#cb140-2" tabindex="-1"></a></span>
<span id="cb140-3"><a href="filling-gaps-in-temperature-records.html#cb140-3" tabindex="-1"></a>Bonn_gaps <span class="ot">&lt;-</span> Bonn <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">obs_Tmin=</span>Tmin,</span>
<span id="cb140-4"><a href="filling-gaps-in-temperature-records.html#cb140-4" tabindex="-1"></a>                             <span class="at">obs_Tmax=</span>Tmax)</span>
<span id="cb140-5"><a href="filling-gaps-in-temperature-records.html#cb140-5" tabindex="-1"></a>Bonn_gaps<span class="sc">$</span>Tmin[Gaps] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb140-6"><a href="filling-gaps-in-temperature-records.html#cb140-6" tabindex="-1"></a>Bonn_gaps<span class="sc">$</span>Tmax[Gaps] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb140-7"><a href="filling-gaps-in-temperature-records.html#cb140-7" tabindex="-1"></a></span>
<span id="cb140-8"><a href="filling-gaps-in-temperature-records.html#cb140-8" tabindex="-1"></a>patch_annual <span class="ot">&lt;-</span> <span class="fu">patch_daily_temps</span>(<span class="at">weather =</span> Bonn_gaps,</span>
<span id="cb140-9"><a href="filling-gaps-in-temperature-records.html#cb140-9" tabindex="-1"></a>                                  <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb140-10"><a href="filling-gaps-in-temperature-records.html#cb140-10" tabindex="-1"></a>                                  <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb140-11"><a href="filling-gaps-in-temperature-records.html#cb140-11" tabindex="-1"></a>                                  <span class="at">max_stdev_bias =</span> <span class="dv">2</span>,</span>
<span id="cb140-12"><a href="filling-gaps-in-temperature-records.html#cb140-12" tabindex="-1"></a>                                  <span class="at">time_interval =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="cb140-13"><a href="filling-gaps-in-temperature-records.html#cb140-13" tabindex="-1"></a>patch_month <span class="ot">&lt;-</span> <span class="fu">patch_daily_temps</span>(<span class="at">weather =</span> Bonn_gaps,</span>
<span id="cb140-14"><a href="filling-gaps-in-temperature-records.html#cb140-14" tabindex="-1"></a>                                 <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb140-15"><a href="filling-gaps-in-temperature-records.html#cb140-15" tabindex="-1"></a>                                 <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb140-16"><a href="filling-gaps-in-temperature-records.html#cb140-16" tabindex="-1"></a>                                 <span class="at">max_stdev_bias =</span> <span class="dv">2</span>,</span>
<span id="cb140-17"><a href="filling-gaps-in-temperature-records.html#cb140-17" tabindex="-1"></a>                                 <span class="at">time_interval =</span> <span class="st">&quot;month&quot;</span>)</span>
<span id="cb140-18"><a href="filling-gaps-in-temperature-records.html#cb140-18" tabindex="-1"></a>patch_2weeks <span class="ot">&lt;-</span> <span class="fu">patch_daily_temps</span>(<span class="at">weather =</span> Bonn_gaps,</span>
<span id="cb140-19"><a href="filling-gaps-in-temperature-records.html#cb140-19" tabindex="-1"></a>                                  <span class="at">patch_weather =</span> patch_weather,</span>
<span id="cb140-20"><a href="filling-gaps-in-temperature-records.html#cb140-20" tabindex="-1"></a>                                  <span class="at">max_mean_bias =</span> <span class="dv">1</span>,</span>
<span id="cb140-21"><a href="filling-gaps-in-temperature-records.html#cb140-21" tabindex="-1"></a>                                  <span class="at">max_stdev_bias =</span> <span class="dv">2</span>,</span>
<span id="cb140-22"><a href="filling-gaps-in-temperature-records.html#cb140-22" tabindex="-1"></a>                                  <span class="at">time_interval =</span> <span class="st">&quot;2 weeks&quot;</span>)</span>
<span id="cb140-23"><a href="filling-gaps-in-temperature-records.html#cb140-23" tabindex="-1"></a></span>
<span id="cb140-24"><a href="filling-gaps-in-temperature-records.html#cb140-24" tabindex="-1"></a>Bonn_gaps[,<span class="st">&quot;Tmin_annual&quot;</span>] <span class="ot">&lt;-</span> Bonn_gaps<span class="sc">$</span>obs_Tmin <span class="sc">-</span> patch_annual<span class="sc">$</span>weather<span class="sc">$</span>Tmin</span>
<span id="cb140-25"><a href="filling-gaps-in-temperature-records.html#cb140-25" tabindex="-1"></a>Bonn_gaps[,<span class="st">&quot;Tmax_annual&quot;</span>] <span class="ot">&lt;-</span> Bonn_gaps<span class="sc">$</span>obs_Tmax <span class="sc">-</span> patch_annual<span class="sc">$</span>weather<span class="sc">$</span>Tmax</span>
<span id="cb140-26"><a href="filling-gaps-in-temperature-records.html#cb140-26" tabindex="-1"></a>Bonn_gaps[,<span class="st">&quot;Tmin_month&quot;</span>] <span class="ot">&lt;-</span> Bonn_gaps<span class="sc">$</span>obs_Tmin <span class="sc">-</span> patch_month<span class="sc">$</span>weather<span class="sc">$</span>Tmin</span>
<span id="cb140-27"><a href="filling-gaps-in-temperature-records.html#cb140-27" tabindex="-1"></a>Bonn_gaps[,<span class="st">&quot;Tmax_month&quot;</span>] <span class="ot">&lt;-</span> Bonn_gaps<span class="sc">$</span>obs_Tmax <span class="sc">-</span> patch_month<span class="sc">$</span>weather<span class="sc">$</span>Tmax</span>
<span id="cb140-28"><a href="filling-gaps-in-temperature-records.html#cb140-28" tabindex="-1"></a>Bonn_gaps[,<span class="st">&quot;Tmin_2weeks&quot;</span>] <span class="ot">&lt;-</span> Bonn_gaps<span class="sc">$</span>obs_Tmin <span class="sc">-</span> patch_2weeks<span class="sc">$</span>weather<span class="sc">$</span>Tmin</span>
<span id="cb140-29"><a href="filling-gaps-in-temperature-records.html#cb140-29" tabindex="-1"></a>Bonn_gaps[,<span class="st">&quot;Tmax_2weeks&quot;</span>] <span class="ot">&lt;-</span> Bonn_gaps<span class="sc">$</span>obs_Tmax <span class="sc">-</span> patch_2weeks<span class="sc">$</span>weather<span class="sc">$</span>Tmax</span>
<span id="cb140-30"><a href="filling-gaps-in-temperature-records.html#cb140-30" tabindex="-1"></a></span>
<span id="cb140-31"><a href="filling-gaps-in-temperature-records.html#cb140-31" tabindex="-1"></a>Interval_eval <span class="ot">&lt;-</span> Bonn_gaps <span class="sc">%&gt;%</span></span>
<span id="cb140-32"><a href="filling-gaps-in-temperature-records.html#cb140-32" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Tmin)) <span class="sc">%&gt;%</span></span>
<span id="cb140-33"><a href="filling-gaps-in-temperature-records.html#cb140-33" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Tmin_annual<span class="sc">:</span>Tmax_2weeks) <span class="sc">%&gt;%</span></span>
<span id="cb140-34"><a href="filling-gaps-in-temperature-records.html#cb140-34" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">factor</span>(name,</span>
<span id="cb140-35"><a href="filling-gaps-in-temperature-records.html#cb140-35" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Tmin_annual&quot;</span>,</span>
<span id="cb140-36"><a href="filling-gaps-in-temperature-records.html#cb140-36" tabindex="-1"></a>                                <span class="st">&quot;Tmin_month&quot;</span>,</span>
<span id="cb140-37"><a href="filling-gaps-in-temperature-records.html#cb140-37" tabindex="-1"></a>                                <span class="st">&quot;Tmin_2weeks&quot;</span>,</span>
<span id="cb140-38"><a href="filling-gaps-in-temperature-records.html#cb140-38" tabindex="-1"></a>                                <span class="st">&quot;Tmax_annual&quot;</span>,</span>
<span id="cb140-39"><a href="filling-gaps-in-temperature-records.html#cb140-39" tabindex="-1"></a>                                <span class="st">&quot;Tmax_month&quot;</span>,</span>
<span id="cb140-40"><a href="filling-gaps-in-temperature-records.html#cb140-40" tabindex="-1"></a>                                <span class="st">&quot;Tmax_2weeks&quot;</span>)) )</span>
<span id="cb140-41"><a href="filling-gaps-in-temperature-records.html#cb140-41" tabindex="-1"></a></span>
<span id="cb140-42"><a href="filling-gaps-in-temperature-records.html#cb140-42" tabindex="-1"></a><span class="fu">ggplot</span>(Interval_eval,</span>
<span id="cb140-43"><a href="filling-gaps-in-temperature-records.html#cb140-43" tabindex="-1"></a>       <span class="fu">aes</span>(Type,value)) <span class="sc">+</span></span>
<span id="cb140-44"><a href="filling-gaps-in-temperature-records.html#cb140-44" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb140-45"><a href="filling-gaps-in-temperature-records.html#cb140-45" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable and bias evaluation interval&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-46"><a href="filling-gaps-in-temperature-records.html#cb140-46" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Prediction error&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>It is also possible to evaluate the mean daily error:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="filling-gaps-in-temperature-records.html#cb141-1" tabindex="-1"></a>error_eval <span class="ot">&lt;-</span></span>
<span id="cb141-2"><a href="filling-gaps-in-temperature-records.html#cb141-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Tmin&quot;</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">&quot;Tmax&quot;</span>,<span class="dv">3</span>)),</span>
<span id="cb141-3"><a href="filling-gaps-in-temperature-records.html#cb141-3" tabindex="-1"></a>             <span class="at">Interval =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>,<span class="st">&quot;Month&quot;</span>,<span class="st">&quot;Two weeks&quot;</span>),<span class="dv">2</span>),</span>
<span id="cb141-4"><a href="filling-gaps-in-temperature-records.html#cb141-4" tabindex="-1"></a>             <span class="at">Error =</span> <span class="fu">c</span>(</span>
<span id="cb141-5"><a href="filling-gaps-in-temperature-records.html#cb141-5" tabindex="-1"></a>             <span class="fu">mean</span>(<span class="fu">abs</span>(Bonn_gaps<span class="sc">$</span>Tmin_annual[<span class="fu">is.na</span>(Bonn_gaps<span class="sc">$</span>Tmin)]),<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb141-6"><a href="filling-gaps-in-temperature-records.html#cb141-6" tabindex="-1"></a>             <span class="fu">mean</span>(<span class="fu">abs</span>(Bonn_gaps<span class="sc">$</span>Tmin_month[<span class="fu">is.na</span>(Bonn_gaps<span class="sc">$</span>Tmin)]),<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb141-7"><a href="filling-gaps-in-temperature-records.html#cb141-7" tabindex="-1"></a>             <span class="fu">mean</span>(<span class="fu">abs</span>(Bonn_gaps<span class="sc">$</span>Tmin_2weeks[<span class="fu">is.na</span>(Bonn_gaps<span class="sc">$</span>Tmin)]),<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb141-8"><a href="filling-gaps-in-temperature-records.html#cb141-8" tabindex="-1"></a>             <span class="fu">mean</span>(<span class="fu">abs</span>(Bonn_gaps<span class="sc">$</span>Tmax_annual[<span class="fu">is.na</span>(Bonn_gaps<span class="sc">$</span>Tmin)]),<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb141-9"><a href="filling-gaps-in-temperature-records.html#cb141-9" tabindex="-1"></a>             <span class="fu">mean</span>(<span class="fu">abs</span>(Bonn_gaps<span class="sc">$</span>Tmax_month[<span class="fu">is.na</span>(Bonn_gaps<span class="sc">$</span>Tmin)]),<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb141-10"><a href="filling-gaps-in-temperature-records.html#cb141-10" tabindex="-1"></a>             <span class="fu">mean</span>(<span class="fu">abs</span>(Bonn_gaps<span class="sc">$</span>Tmax_2weeks[<span class="fu">is.na</span>(Bonn_gaps<span class="sc">$</span>Tmin)]),<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb141-11"><a href="filling-gaps-in-temperature-records.html#cb141-11" tabindex="-1"></a>             )</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="filling-gaps-in-temperature-records.html#cb142-1" tabindex="-1"></a>error_eval</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Variable
</th>
<th style="text-align:center;">
Interval
</th>
<th style="text-align:center;">
Error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Tmin
</td>
<td style="text-align:center;">
Year
</td>
<td style="text-align:center;">
0.9937002
</td>
</tr>
<tr>
<td style="text-align:center;">
Tmin
</td>
<td style="text-align:center;">
Month
</td>
<td style="text-align:center;">
0.9852960
</td>
</tr>
<tr>
<td style="text-align:center;">
Tmin
</td>
<td style="text-align:center;">
Two weeks
</td>
<td style="text-align:center;">
0.9859109
</td>
</tr>
<tr>
<td style="text-align:center;">
Tmax
</td>
<td style="text-align:center;">
Year
</td>
<td style="text-align:center;">
0.8301270
</td>
</tr>
<tr>
<td style="text-align:center;">
Tmax
</td>
<td style="text-align:center;">
Month
</td>
<td style="text-align:center;">
0.8067909
</td>
</tr>
<tr>
<td style="text-align:center;">
Tmax
</td>
<td style="text-align:center;">
Two weeks
</td>
<td style="text-align:center;">
0.8094851
</td>
</tr>
</tbody>
</table>
<p>The improvement in the results was not very significant, likely because the stations used are relatively close to each other, and the weather conditions between them do not vary much.</p>
</div>
<div id="saving-the-data-for-later" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Saving the data for later<a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The dataset based on monthly intervals should be saved for later use. Before saving, the remaining missing day needs to be interpolated. Once this gap is filled, the dataset can be stored for future use.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="filling-gaps-in-temperature-records.html#cb143-1" tabindex="-1"></a>monthly_bias_fixed <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(patched_monthly)</span></code></pre></div>
<p>The long-term record for Bonn, covering the period from 1990 to 2020, is now complete with no remaining gaps. This dataset can now be saved for future use.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="filling-gaps-in-temperature-records.html#cb144-1" tabindex="-1"></a><span class="fu">write.csv</span>(monthly_bias_fixed<span class="sc">$</span>weather,</span>
<span id="cb144-2"><a href="filling-gaps-in-temperature-records.html#cb144-2" tabindex="-1"></a>          <span class="st">&quot;data/Bonn_weather.csv&quot;</span>)</span></code></pre></div>
<p>Only the weather element, a <code>data.frame</code>, was saved, as it can be easily exported as a spreadsheet (<code>.csv</code> file). While it is also possible to save lists, such as the <code>QC</code> element, this requires a more complex process, so it will be saved at a later time.</p>
</div>
</div>
<div id="exercises-on-filling-gaps" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> <code>Exercises</code> on filling gaps<a href="filling-gaps-in-temperature-records.html#exercises-on-filling-gaps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><em>Use</em> <code>chillR</code> <em>functions to find out how many gaps you have in your dataset (even if you have none, please still follow all further steps)</em></li>
</ol>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="filling-gaps-in-temperature-records.html#cb145-1" tabindex="-1"></a>Yakima <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Yakima/chillR_weather.csv&quot;</span>)</span>
<span id="cb145-2"><a href="filling-gaps-in-temperature-records.html#cb145-2" tabindex="-1"></a>Yakima_QC <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(Yakima)<span class="sc">$</span>QC</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; ">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
End_year
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Season_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Data_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Missing_Tmax
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Incomplete_days
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Perc_complete
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1989/1990
</td>
<td style="text-align:center;">
1990
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1990/1991
</td>
<td style="text-align:center;">
1991
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1991/1992
</td>
<td style="text-align:center;">
1992
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1992/1993
</td>
<td style="text-align:center;">
1993
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1993/1994
</td>
<td style="text-align:center;">
1994
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1994/1995
</td>
<td style="text-align:center;">
1995
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1995/1996
</td>
<td style="text-align:center;">
1996
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1996/1997
</td>
<td style="text-align:center;">
1997
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1997/1998
</td>
<td style="text-align:center;">
1998
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1998/1999
</td>
<td style="text-align:center;">
1999
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
1999/2000
</td>
<td style="text-align:center;">
2000
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2000/2001
</td>
<td style="text-align:center;">
2001
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2001/2002
</td>
<td style="text-align:center;">
2002
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2002/2003
</td>
<td style="text-align:center;">
2003
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2003/2004
</td>
<td style="text-align:center;">
2004
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2004/2005
</td>
<td style="text-align:center;">
2005
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2005/2006
</td>
<td style="text-align:center;">
2006
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2006/2007
</td>
<td style="text-align:center;">
2007
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2008/2009
</td>
<td style="text-align:center;">
2009
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2009/2010
</td>
<td style="text-align:center;">
2010
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2010/2011
</td>
<td style="text-align:center;">
2011
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2011/2012
</td>
<td style="text-align:center;">
2012
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2012/2013
</td>
<td style="text-align:center;">
2013
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2013/2014
</td>
<td style="text-align:center;">
2014
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2014/2015
</td>
<td style="text-align:center;">
2015
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2015/2016
</td>
<td style="text-align:center;">
2016
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2016/2017
</td>
<td style="text-align:center;">
2017
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2017/2018
</td>
<td style="text-align:center;">
2018
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2018/2019
</td>
<td style="text-align:center;">
2019
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
365
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
2019/2020
</td>
<td style="text-align:center;">
2020
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
366
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
100
</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" style="list-style-type: decimal">
<li><em>Create a list of the 25 closest weather stations using the</em> <code>handle_gsod</code> <em>function</em></li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="filling-gaps-in-temperature-records.html#cb146-1" tabindex="-1"></a>station_list_Yakima <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;list_stations&quot;</span>,</span>
<span id="cb146-2"><a href="filling-gaps-in-temperature-records.html#cb146-2" tabindex="-1"></a>                                   <span class="at">location =</span> <span class="fu">c</span>(<span class="at">long =</span> <span class="sc">-</span><span class="fl">120.50</span>, <span class="at">lat =</span> <span class="fl">46.60</span>),</span>
<span id="cb146-3"><a href="filling-gaps-in-temperature-records.html#cb146-3" tabindex="-1"></a>                                   <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">2020</span>))</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; ">
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
chillR_code
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
STATION.NAME
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
CTRY
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Lat
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Long
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
BEGIN
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
END
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Distance
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Overlap_years
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Perc_interval_covered
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
72781024243
</td>
<td style="text-align:center;">
YAKIMA AIR TERMINAL/MCALSR FIELD AP
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.564
</td>
<td style="text-align:center;">
-120.535
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
4.82
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
99999924243
</td>
<td style="text-align:center;">
YAKIMA AIR TERMINAL
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.568
</td>
<td style="text-align:center;">
-120.543
</td>
<td style="text-align:center;">
19480101
</td>
<td style="text-align:center;">
19721231
</td>
<td style="text-align:center;">
4.85
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
72781399999
</td>
<td style="text-align:center;">
VAGABOND AAF / YAKIMA TRAINING CENTER WASHINGTON USA
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.667
</td>
<td style="text-align:center;">
-120.454
</td>
<td style="text-align:center;">
20030617
</td>
<td style="text-align:center;">
20081110
</td>
<td style="text-align:center;">
8.25
</td>
<td style="text-align:center;">
5.40
</td>
<td style="text-align:center;">
17
</td>
</tr>
<tr>
<td style="text-align:center;">
72056299999
</td>
<td style="text-align:center;">
RANGE OP 13 / YAKIMA TRAINING CENTER
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.800
</td>
<td style="text-align:center;">
-120.167
</td>
<td style="text-align:center;">
20080530
</td>
<td style="text-align:center;">
20170920
</td>
<td style="text-align:center;">
33.79
</td>
<td style="text-align:center;">
9.31
</td>
<td style="text-align:center;">
30
</td>
</tr>
<tr>
<td style="text-align:center;">
72788399999
</td>
<td style="text-align:center;">
BOWERS FLD
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.033
</td>
<td style="text-align:center;">
-120.531
</td>
<td style="text-align:center;">
20000101
</td>
<td style="text-align:center;">
20031231
</td>
<td style="text-align:center;">
48.26
</td>
<td style="text-align:center;">
4.00
</td>
<td style="text-align:center;">
13
</td>
</tr>
<tr>
<td style="text-align:center;">
72788324220
</td>
<td style="text-align:center;">
BOWERS FIELD AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.034
</td>
<td style="text-align:center;">
-120.531
</td>
<td style="text-align:center;">
19880106
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
48.37
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
99999924220
</td>
<td style="text-align:center;">
ELLENSBURG BOWERS FI
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.034
</td>
<td style="text-align:center;">
-120.530
</td>
<td style="text-align:center;">
19480601
</td>
<td style="text-align:center;">
19550101
</td>
<td style="text-align:center;">
48.37
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
72784094187
</td>
<td style="text-align:center;">
HANFORD AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.567
</td>
<td style="text-align:center;">
-119.600
</td>
<td style="text-align:center;">
20060101
</td>
<td style="text-align:center;">
20130326
</td>
<td style="text-align:center;">
68.96
</td>
<td style="text-align:center;">
7.23
</td>
<td style="text-align:center;">
23
</td>
</tr>
<tr>
<td style="text-align:center;">
72784099999
</td>
<td style="text-align:center;">
HANFORD
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.567
</td>
<td style="text-align:center;">
-119.600
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
19971231
</td>
<td style="text-align:center;">
68.96
</td>
<td style="text-align:center;">
8.00
</td>
<td style="text-align:center;">
26
</td>
</tr>
<tr>
<td style="text-align:center;">
72782594239
</td>
<td style="text-align:center;">
PANGBORN MEMORIAL AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.397
</td>
<td style="text-align:center;">
-120.201
</td>
<td style="text-align:center;">
20000101
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
91.58
</td>
<td style="text-align:center;">
21.00
</td>
<td style="text-align:center;">
68
</td>
</tr>
<tr>
<td style="text-align:center;">
72782599999
</td>
<td style="text-align:center;">
PANGBORN MEM
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.399
</td>
<td style="text-align:center;">
-120.207
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
19971231
</td>
<td style="text-align:center;">
91.69
</td>
<td style="text-align:center;">
8.00
</td>
<td style="text-align:center;">
26
</td>
</tr>
<tr>
<td style="text-align:center;">
72788499999
</td>
<td style="text-align:center;">
RICHLAND AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.306
</td>
<td style="text-align:center;">
-119.304
</td>
<td style="text-align:center;">
19810203
</td>
<td style="text-align:center;">
20250302
</td>
<td style="text-align:center;">
97.39
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
72781524237
</td>
<td style="text-align:center;">
STAMPASS PASS FLTWO
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.277
</td>
<td style="text-align:center;">
-121.337
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
98.63
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
99999924237
</td>
<td style="text-align:center;">
STAMPEDE PASS
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.277
</td>
<td style="text-align:center;">
-121.337
</td>
<td style="text-align:center;">
19480101
</td>
<td style="text-align:center;">
19721231
</td>
<td style="text-align:center;">
98.63
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
72790024141
</td>
<td style="text-align:center;">
EPHRATA MUNICIPAL AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.308
</td>
<td style="text-align:center;">
-119.516
</td>
<td style="text-align:center;">
20050101
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
108.64
</td>
<td style="text-align:center;">
16.00
</td>
<td style="text-align:center;">
52
</td>
</tr>
<tr>
<td style="text-align:center;">
72782624141
</td>
<td style="text-align:center;">
EPHRATA MUNICIPAL
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.308
</td>
<td style="text-align:center;">
-119.515
</td>
<td style="text-align:center;">
19420101
</td>
<td style="text-align:center;">
19971231
</td>
<td style="text-align:center;">
108.69
</td>
<td style="text-align:center;">
8.00
</td>
<td style="text-align:center;">
26
</td>
</tr>
<tr>
<td style="text-align:center;">
99999924141
</td>
<td style="text-align:center;">
EPHRATA AP FCWOS
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.308
</td>
<td style="text-align:center;">
-119.515
</td>
<td style="text-align:center;">
19480101
</td>
<td style="text-align:center;">
19550101
</td>
<td style="text-align:center;">
108.69
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
72782724110
</td>
<td style="text-align:center;">
GRANT COUNTY INTL AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.193
</td>
<td style="text-align:center;">
-119.315
</td>
<td style="text-align:center;">
19430610
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
111.73
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
72782799999
</td>
<td style="text-align:center;">
MOSES LAKE/GRANT CO
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
47.200
</td>
<td style="text-align:center;">
-119.317
</td>
<td style="text-align:center;">
20000101
</td>
<td style="text-align:center;">
20031231
</td>
<td style="text-align:center;">
112.06
</td>
<td style="text-align:center;">
4.00
</td>
<td style="text-align:center;">
13
</td>
</tr>
<tr>
<td style="text-align:center;">
72784524163
</td>
<td style="text-align:center;">
TRI-CITIES AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.270
</td>
<td style="text-align:center;">
-119.118
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
112.21
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
72784599999
</td>
<td style="text-align:center;">
TRI CITIES
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.267
</td>
<td style="text-align:center;">
-119.117
</td>
<td style="text-align:center;">
20000101
</td>
<td style="text-align:center;">
20031231
</td>
<td style="text-align:center;">
112.40
</td>
<td style="text-align:center;">
4.00
</td>
<td style="text-align:center;">
13
</td>
</tr>
<tr>
<td style="text-align:center;">
99999924163
</td>
<td style="text-align:center;">
PASCO NAS
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
46.267
</td>
<td style="text-align:center;">
-119.117
</td>
<td style="text-align:center;">
19450401
</td>
<td style="text-align:center;">
19460601
</td>
<td style="text-align:center;">
112.40
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
72698824219
</td>
<td style="text-align:center;">
MUNICIPAL AIRPORT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
45.619
</td>
<td style="text-align:center;">
-121.166
</td>
<td style="text-align:center;">
19730101
</td>
<td style="text-align:center;">
20250303
</td>
<td style="text-align:center;">
120.70
</td>
<td style="text-align:center;">
31.00
</td>
<td style="text-align:center;">
100
</td>
</tr>
<tr>
<td style="text-align:center;">
99999924219
</td>
<td style="text-align:center;">
THE DALLES MUNICIPAL ARPT
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
45.619
</td>
<td style="text-align:center;">
-121.166
</td>
<td style="text-align:center;">
19480101
</td>
<td style="text-align:center;">
19650101
</td>
<td style="text-align:center;">
120.70
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
72688399999
</td>
<td style="text-align:center;">
HERMISTON MUNI
</td>
<td style="text-align:center;">
US
</td>
<td style="text-align:center;">
45.828
</td>
<td style="text-align:center;">
-119.259
</td>
<td style="text-align:center;">
19980514
</td>
<td style="text-align:center;">
20051231
</td>
<td style="text-align:center;">
128.55
</td>
<td style="text-align:center;">
7.64
</td>
<td style="text-align:center;">
25
</td>
</tr>
</tbody>
</table>
</div>
<ol start="3" style="list-style-type: decimal">
<li><em>Identify suitable weather stations for patching gaps</em></li>
<li><em>Download weather data for promising stations, convert them to</em> <code>chillR</code> <em>format and compile them in a list</em></li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="filling-gaps-in-temperature-records.html#cb147-1" tabindex="-1"></a>patch_weather <span class="ot">&lt;-</span></span>
<span id="cb147-2"><a href="filling-gaps-in-temperature-records.html#cb147-2" tabindex="-1"></a>  <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;download_weather&quot;</span>,</span>
<span id="cb147-3"><a href="filling-gaps-in-temperature-records.html#cb147-3" tabindex="-1"></a>              <span class="at">location =</span> <span class="fu">as.character</span>(station_list_Yakima<span class="sc">$</span>chillR_code[<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>)]),</span>
<span id="cb147-4"><a href="filling-gaps-in-temperature-records.html#cb147-4" tabindex="-1"></a>              <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">2020</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb147-5"><a href="filling-gaps-in-temperature-records.html#cb147-5" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span></code></pre></div>
<pre><code>## Loading data for 31 years from station &#39;RANGE OP 13 / YAKIMA TRAINING CENTER&#39;
## ==============================================================================================
## 
## Loading data for 31 years from station &#39;HANFORD AIRPORT&#39;
## ==============================================================================================
## 
## Loading data for 31 years from station &#39;BOWERS FIELD AIRPORT&#39;
## ==============================================================================================</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><p><em>Use the</em> <code>patch_daily_temperatures</code> <em>function to fill gaps</em></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="filling-gaps-in-temperature-records.html#cb149-1" tabindex="-1"></a>patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(<span class="at">weather =</span> Yakima,</span>
<span id="cb149-2"><a href="filling-gaps-in-temperature-records.html#cb149-2" tabindex="-1"></a>                                    <span class="at">patch_weather =</span> patch_weather)</span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="filling-gaps-in-temperature-records.html#cb150-1" tabindex="-1"></a><span class="co"># Patch statistics for YRANGE OP 13 /AKIMA TRAINING CENTER</span></span>
<span id="cb150-2"><a href="filling-gaps-in-temperature-records.html#cb150-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">1</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
<p>mean_bias</p>
</th>
<th style="text-align:center;">
<p>stdev_bias</p>
</th>
<th style="text-align:center;">
<p>filled</p>
</th>
<th style="text-align:center;">
<p>gaps_remain</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<p>Tmin</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Tmax</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="filling-gaps-in-temperature-records.html#cb151-1" tabindex="-1"></a><span class="co"># Patch statistics for HANFORD AIRPORT</span></span>
<span id="cb151-2"><a href="filling-gaps-in-temperature-records.html#cb151-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">2</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
<p>mean_bias</p>
</th>
<th style="text-align:center;">
<p>stdev_bias</p>
</th>
<th style="text-align:center;">
<p>filled</p>
</th>
<th style="text-align:center;">
<p>gaps_remain</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<p>Tmin</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Tmax</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="filling-gaps-in-temperature-records.html#cb152-1" tabindex="-1"></a><span class="co"># Patch statistics for BOWERS FIELD AIRPORT</span></span>
<span id="cb152-2"><a href="filling-gaps-in-temperature-records.html#cb152-2" tabindex="-1"></a>patched<span class="sc">$</span>statistics[[<span class="dv">3</span>]]</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
<p>mean_bias</p>
</th>
<th style="text-align:center;">
<p>stdev_bias</p>
</th>
<th style="text-align:center;">
<p>filled</p>
</th>
<th style="text-align:center;">
<p>gaps_remain</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<p>Tmin</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Tmax</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
<td style="text-align:center;">
<p>NA</p>
</td>
</tr>
</tbody>
</table></li>
<li><p><em>Investigate the results - have all gaps been filled?</em></p></li>
</ol>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="filling-gaps-in-temperature-records.html#cb153-1" tabindex="-1"></a><span class="fu">write.csv</span>(patched<span class="sc">$</span>weather,</span>
<span id="cb153-2"><a href="filling-gaps-in-temperature-records.html#cb153-2" tabindex="-1"></a>          <span class="st">&quot;Yakima/Yakima_weather.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="some-useful-tools-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="getting-temperature-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/edit/main/11-gaps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/blob/main/11-gaps.Rmd",
"text": null
},
"download": ["bookdownproj.pdf", "bookdownproj.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
