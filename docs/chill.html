<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Chill | Tree phenology analysis with R</title>
  <meta name="description" content="Chapter 7 Chill | Tree phenology analysis with R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Chill | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Chill | Tree phenology analysis with R" />
  
  
  

<meta name="author" content="Jacqueline Wingen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="manual-chill.html"/>
<link rel="next" href="making-hourly-temperatures.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Analysis with R</a></li>
<li><a href="index.html"><img src="images/chillR_hexSticker.png" width="75%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the Module</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> Git and Github</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="3.6" data-path="tree-dormancy.html"><a href="tree-dormancy.html#excercises-on-tree-dormancy"><i class="fa fa-check"></i><b>3.6</b> <code>Excercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#whats-already-known"><i class="fa fa-check"></i><b>4.2</b> What’s already known</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projections-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projections approaches</a></li>
<li class="chapter" data-level="4.5" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises-on-climate-change"><i class="fa fa-check"></i><b>4.5</b> <code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.2</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.3</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.4</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.5</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.6</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.7</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.8</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.9</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.10</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.11</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.12</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.13</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.14" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises-on-past-chill-projections"><i class="fa fa-check"></i><b>5.14</b> <code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill.html"><a href="manual-chill.html"><i class="fa fa-check"></i><b>6</b> Manual chill</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill.html"><a href="manual-chill.html#learning-goals-3"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill.html"><a href="manual-chill.html#chilling-hours-calculation-using-chillr"><i class="fa fa-check"></i><b>6.2</b> Chilling hours calculation using chillR</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="manual-chill.html"><a href="manual-chill.html#data-requirements"><i class="fa fa-check"></i><b>6.2.1</b> <strong>Data Requirements</strong></a></li>
<li class="chapter" data-level="6.2.2" data-path="manual-chill.html"><a href="manual-chill.html#loading-and-preparing-data"><i class="fa fa-check"></i><b>6.2.2</b> Loading and Preparing Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="manual-chill.html"><a href="manual-chill.html#manual-calculation-of-chilling-hours"><i class="fa fa-check"></i><b>6.2.3</b> <strong>Manual Calculation of Chilling Hours</strong></a></li>
<li class="chapter" data-level="6.2.4" data-path="manual-chill.html"><a href="manual-chill.html#automation-with-functions"><i class="fa fa-check"></i><b>6.2.4</b> Automation with Functions</a></li>
<li class="chapter" data-level="6.2.5" data-path="manual-chill.html"><a href="manual-chill.html#application-example"><i class="fa fa-check"></i><b>6.2.5</b> Application Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manual-chill.html"><a href="manual-chill.html#exercises-on-basic-chill-modeling"><i class="fa fa-check"></i><b>6.3</b> <code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill.html"><a href="chill.html"><i class="fa fa-check"></i><b>7</b> Chill</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill.html"><a href="chill.html#learning-goals-4"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="chill.html"><a href="chill.html#chilling_hours-function"><i class="fa fa-check"></i><b>7.2</b> <code>Chilling_Hours()</code> function</a></li>
<li class="chapter" data-level="7.3" data-path="chill.html"><a href="chill.html#utah-model"><i class="fa fa-check"></i><b>7.3</b> Utah Model</a></li>
<li class="chapter" data-level="7.4" data-path="chill.html"><a href="chill.html#creating-custom-chill-models-with-step_model"><i class="fa fa-check"></i><b>7.4</b> Creating Custom Chill Models with <code>step_model()</code></a></li>
<li class="chapter" data-level="7.5" data-path="chill.html"><a href="chill.html#dynamic-model"><i class="fa fa-check"></i><b>7.5</b> Dynamic model</a></li>
<li class="chapter" data-level="7.6" data-path="chill.html"><a href="chill.html#chilling-and-tempresponse-functions"><i class="fa fa-check"></i><b>7.6</b> <code>Chilling</code> and <code>tempResponse</code> functions</a></li>
<li class="chapter" data-level="7.7" data-path="chill.html"><a href="chill.html#exercises-on-chill-models"><i class="fa fa-check"></i><b>7.7</b> <code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#learning-goals-5"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.2</b> Generating hourly temperatures</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.3</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.4" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.4</b> Empirical daily temperature curves</a></li>
<li class="chapter" data-level="8.5" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures"><i class="fa fa-check"></i><b>8.5</b> <code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chill" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Chill<a href="chill.html#chill" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, various chill models will be explored using the <code>chillR</code> package in R, which simplifies the calculation of chilling hours and other dormancy-related metrics based on temperature data.</p>
<div id="learning-goals-4" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Learning goals<a href="chill.html#learning-goals-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Learn how to run chill models using <code>chillR</code></li>
<li>Learn how to produce your own temperature response model in <code>chillR</code></li>
</ul>
</div>
<div id="chilling_hours-function" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> <code>Chilling_Hours()</code> function<a href="chill.html#chilling_hours-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>Chilling_Hours()</code> function calculates the time during which temperatures fall within a key range for chill accumulation. It takes hourly temperature data as input and, by default, provides the cumulative amount of chilling accumulated over time.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chill.html#cb14-1" tabindex="-1"></a><span class="fu">Chilling_Hours</span>(Winters_hours_gaps<span class="sc">$</span>Temp)[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span></code></pre></div>
<pre><code>##   [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  2  2  2  3  4  5  6  6  6  6  6  6  6  6
##  [30]  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6
##  [59]  6  6  6  7  8  9 10 11 12 13 14 15 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 18
##  [88] 19 20 21 22 23 24 25 25 25 25 25 25 25</code></pre>
<p>The result will show the first 100 values, where the cumulative chilling hours increase as the temperature falls within the specified range.</p>
</div>
<div id="utah-model" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Utah Model<a href="chill.html#utah-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Utah Model assigns different weights to various temperature ranges, reflecting their impact on chill accumulation. The <code>Utah_Model()</code> function in <code>chillR</code> calculates these weighted chilling contributions for each hour of temperature data. The output will show the Utah model values for the first 100 hours, where positive, zero, and negative weights are applied based on the temperature:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chill.html#cb16-1" tabindex="-1"></a><span class="fu">Utah_Model</span>(Winters_hours_gaps<span class="sc">$</span>Temp)[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span></code></pre></div>
<pre><code>##   [1]  0.0 -0.5 -1.5 -2.5 -3.5 -4.5 -5.5 -6.0 -6.0 -6.0 -5.5 -5.0 -4.0 -3.0 -2.0 -1.0  0.0
##  [18]  0.5  1.5  2.5  3.5  4.5  5.0  5.0  5.0  4.0  3.0  2.0  1.0  0.0 -1.0 -2.0 -2.5 -2.5
##  [35] -2.0 -1.5 -1.0 -0.5  0.5  1.0  1.5  2.0  2.0  2.5  3.0  3.5  4.0  4.0  4.0  3.5  2.5
##  [52]  1.5  0.5 -0.5 -1.5 -2.5 -3.0 -3.0 -2.5 -1.5 -0.5  0.5  1.5  2.5  3.5  4.5  5.5  6.5
##  [69]  7.5  8.5  9.5 10.0 10.0  9.5  9.0  8.5  8.0  7.5  7.0  6.5  6.5  7.0  7.5  8.5  9.5
##  [86] 10.5 11.5 12.5 13.5 14.5 15.5 16.5 17.5 18.5 19.0 19.0 19.0 18.5 17.5 16.5</code></pre>
</div>
<div id="creating-custom-chill-models-with-step_model" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Creating Custom Chill Models with <code>step_model()</code><a href="chill.html#creating-custom-chill-models-with-step_model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>step_model()</code> function, part of the <code>chillR</code> package, enables the creation of custom chill models based on temperature thresholds and weights. This process involves defining a data frame that specifies temperature ranges and their corresponding weights. Here’s an example of a data frame that defines temperature ranges and their corresponding weights:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chill.html#cb18-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="chill.html#cb18-2" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>,    <span class="dv">6</span>),</span>
<span id="cb18-3"><a href="chill.html#cb18-3" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">c</span>(    <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1000</span>),</span>
<span id="cb18-4"><a href="chill.html#cb18-4" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(   <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>,    <span class="dv">0</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
lower
</th>
<th style="text-align:center;">
upper
</th>
<th style="text-align:center;">
weight
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
-1000
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
3
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
1000
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p>A function called <code>custom()</code> implements a chill model based on this data frame. This function is then applied to the <code>Winters_hours_gaps</code> dataset to calculate the chilling contributions:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chill.html#cb19-1" tabindex="-1"></a>custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">step_model</span>(x, df)</span>
<span id="cb19-2"><a href="chill.html#cb19-2" tabindex="-1"></a><span class="fu">custom</span>(Winters_hours_gaps<span class="sc">$</span>Temp)[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span></code></pre></div>
<pre><code>##   [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  4  7  7  7  7  7  7  7  7
##  [30]  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7
##  [59]  7  7  7  7  7  7  8 10 13 16 19 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22
##  [88] 23 25 27 29 31 34 37 37 37 37 37 37 37</code></pre>
</div>
<div id="dynamic-model" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Dynamic model<a href="chill.html#dynamic-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Dynamic Model provides a more complex and reliable approach to calculating chill, with the <code>Dynamic_Model()</code> function handling the intricate equations involved. This function can be easily applied to the <code>Winters_hours_gaps</code> dataset, producing output that displays dynamic chill values for the first 100 hours, reflecting the underlying physiological processes:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chill.html#cb21-1" tabindex="-1"></a><span class="fu">Dynamic_Model</span>(Winters_hours_gaps<span class="sc">$</span>Temp)[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span></code></pre></div>
<pre><code>##   [1] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##   [9] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##  [17] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##  [25] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##  [33] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##  [41] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##  [49] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##  [57] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
##  [65] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.9698435
##  [73] 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435
##  [81] 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435
##  [89] 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435 0.9698435
##  [97] 0.9698435 0.9698435 0.9698435 0.9698435</code></pre>
</div>
<div id="chilling-and-tempresponse-functions" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> <code>Chilling</code> and <code>tempResponse</code> functions<a href="chill.html#chilling-and-tempresponse-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>chillR</code> package offers several functions for analyzing hourly temperature data, including wrapper functions that enable the computation of chill between specific start and end dates. The <code>chilling()</code> function automatically calculates various basic metrics, including Chilling Hours, Utah Model, Dynamic Model, and Growing Degree Hours. It is important to use the <code>make_JDay()</code> function to add Julian dates (which count the days of the year) to the dataset, ensuring proper functionality.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chill.html#cb23-1" tabindex="-1"></a>chill_output <span class="ot">&lt;-</span> <span class="fu">chilling</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps), <span class="at">Start_JDay =</span> <span class="dv">90</span>, <span class="at">End_JDay =</span> <span class="dv">100</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Season
</th>
<th style="text-align:center;">
End_year
</th>
<th style="text-align:center;">
Season_days
</th>
<th style="text-align:center;">
Data_days
</th>
<th style="text-align:center;">
Perc_complete
</th>
<th style="text-align:center;">
Chilling_Hours
</th>
<th style="text-align:center;">
Utah_Model
</th>
<th style="text-align:center;">
Chill_portions
</th>
<th style="text-align:center;">
GDH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
100
</td>
<td style="text-align:center;">
40
</td>
<td style="text-align:center;">
15.5
</td>
<td style="text-align:center;">
2.009147
</td>
<td style="text-align:center;">
2406.52
</td>
</tr>
</tbody>
</table>
</div>
<p>However, there may be instances where not all metrics are desired, or there is a need for different metrics altogether. In such cases, the <code>tempResponse</code> function can be employed. This function is similar to <code>chilling()</code> but offers the flexibility to take a list of specific temperature models to be computed as input.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chill.html#cb24-1" tabindex="-1"></a>chill_output <span class="ot">&lt;-</span> <span class="fu">tempResponse</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps), </span>
<span id="cb24-2"><a href="chill.html#cb24-2" tabindex="-1"></a>                       <span class="at">Start_JDay =</span> <span class="dv">90</span>, </span>
<span id="cb24-3"><a href="chill.html#cb24-3" tabindex="-1"></a>                       <span class="at">End_JDay =</span> <span class="dv">100</span>, </span>
<span id="cb24-4"><a href="chill.html#cb24-4" tabindex="-1"></a>                       <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Chill_Portions =</span> Dynamic_Model, <span class="at">GDH =</span> GDH))</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Season
</th>
<th style="text-align:center;">
End_year
</th>
<th style="text-align:center;">
Season_days
</th>
<th style="text-align:center;">
Data_days
</th>
<th style="text-align:center;">
Perc_complete
</th>
<th style="text-align:center;">
Chill_Portions
</th>
<th style="text-align:center;">
GDH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
100
</td>
<td style="text-align:center;">
2.009147
</td>
<td style="text-align:center;">
2406.52
</td>
</tr>
</tbody>
</table>
<p>This will return only the Dynamic Model and Growing Degree Hours (GDH<strong>)</strong> values for the specified period.</p>
</div>
<div id="exercises-on-chill-models" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> <code>Exercises</code> on chill models<a href="chill.html#exercises-on-chill-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><em>Run the</em> <code>chilling()</code> <em>function on the</em> <code>Winters_hours_gap</code> <em>dataset.</em></li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chill.html#cb25-1" tabindex="-1"></a>august <span class="ot">&lt;-</span> <span class="fu">chilling</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps), <span class="at">Start_JDay =</span> <span class="dv">214</span>, <span class="at">End_JDay =</span> <span class="dv">244</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-responsive" style="font-size: 14px; color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Season
</th>
<th style="text-align:center;">
End_year
</th>
<th style="text-align:center;">
Season_days
</th>
<th style="text-align:center;">
Data_days
</th>
<th style="text-align:center;">
Perc_complete
</th>
<th style="text-align:center;">
Chilling_Hours
</th>
<th style="text-align:center;">
Utah_Model
</th>
<th style="text-align:center;">
Chill_portions
</th>
<th style="text-align:center;">
GDH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
100
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
-569.5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
9933.327
</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" style="list-style-type: decimal">
<li><em>Create your own temperature-weighting chill model using the</em> <code>step_model()</code> <em>function.</em></li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chill.html#cb26-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-2"><a href="chill.html#cb26-2" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">0</span>,  <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>,   <span class="dv">25</span>),  </span>
<span id="cb26-3"><a href="chill.html#cb26-3" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">c</span>(    <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">1000</span>), </span>
<span id="cb26-4"><a href="chill.html#cb26-4" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(   <span class="dv">0</span>, <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">2</span>,  <span class="dv">1</span>,    <span class="dv">0</span>))</span>
<span id="cb26-5"><a href="chill.html#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="chill.html#cb26-6" tabindex="-1"></a>custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">step_model</span>(x, df)</span></code></pre></div>
<table class="table table-striped table-hover" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
lower
</th>
<th style="text-align:center;">
upper
</th>
<th style="text-align:center;">
weight
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
-1000
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
3
</td>
</tr>
<tr>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
1000
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: decimal">
<li><em>Run this model on the</em> <code>Winters_hours_gaps</code> <em>dataset using the</em> <code>tempResponse()</code> <em>function.</em></li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chill.html#cb27-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb27-2"><a href="chill.html#cb27-2" tabindex="-1"></a>  <span class="at">Chilling_Hours =</span> Chilling_Hours,</span>
<span id="cb27-3"><a href="chill.html#cb27-3" tabindex="-1"></a>  <span class="at">Utah_Chill_Units =</span> Utah_Model,</span>
<span id="cb27-4"><a href="chill.html#cb27-4" tabindex="-1"></a>  <span class="at">Chill_Portions =</span> Dynamic_Model,</span>
<span id="cb27-5"><a href="chill.html#cb27-5" tabindex="-1"></a>  <span class="at">GDH =</span> GDH,</span>
<span id="cb27-6"><a href="chill.html#cb27-6" tabindex="-1"></a>  <span class="at">custom =</span> custom)</span>
<span id="cb27-7"><a href="chill.html#cb27-7" tabindex="-1"></a></span>
<span id="cb27-8"><a href="chill.html#cb27-8" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">tempResponse</span>(<span class="fu">make_JDay</span>(Winters_hours_gaps), </span>
<span id="cb27-9"><a href="chill.html#cb27-9" tabindex="-1"></a>                       <span class="at">Start_JDay =</span> <span class="dv">214</span>, </span>
<span id="cb27-10"><a href="chill.html#cb27-10" tabindex="-1"></a>                       <span class="at">End_JDay =</span> <span class="dv">244</span>, </span>
<span id="cb27-11"><a href="chill.html#cb27-11" tabindex="-1"></a>                       models)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-responsive" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Season
</th>
<th style="text-align:center;">
End_year
</th>
<th style="text-align:center;">
Season_days
</th>
<th style="text-align:center;">
Data_days
</th>
<th style="text-align:center;">
Perc_complete
</th>
<th style="text-align:center;">
Chilling_Hours
</th>
<th style="text-align:center;">
Utah_Chill_Units
</th>
<th style="text-align:center;">
Chill_Portions
</th>
<th style="text-align:center;">
GDH
</th>
<th style="text-align:center;">
custom
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2007/2008
</td>
<td style="text-align:center;">
2008
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
100
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
-569.5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
9933.327
</td>
<td style="text-align:center;">
838
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manual-chill.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="making-hourly-temperatures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/edit/main/07-chill.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jacqwng/Tree-Phenology-R/blob/main/07-chill.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
